{"id":"2JCAUQ8JQ","name":"Spark ML Research","paragraphs":[{"title":"Spark ML для задачи оттока","text":"%md\n# Spark ML для задачи оттока\n\nИсточник данных: [Kaggle](https://www.kaggle.com/sakshigoyal7/credit-card-customers)\n\nОписания полей:\n\n | Название        | Описание                                                                                                                            |\n |:----------------|:------------------------------------------------------------------------------------------------------------------------------------|\n | CLIENTNUM       | Client number. Unique identifier for the customer holding the account                                                               |\n | Attrition_Flag  | Internal event (customer activity) variable                                                                                         |\n | Customer_Age    | Demographic variable - Customer's Age in Years                                                                                      |\n | Gender          | Demographic variable - M=Male, F=Female                                                                                             |\n | Dependent_count | Demographic variable - Number of dependents                                                                                         |\n | Education_Level | Demographic variable - Educational Qualification of the account holder (example: high school, college graduate, etc.)               |\n | Marital_Status  | Demographic variable - Married, Single, Divorced, Unknown                                                                           |\n | Income_Category | Demographic variable - Annual Income Category of the account holder (< $40K, $40K - 60K, $60K - $80K, $80K-$120K, > $120K, Unknown) |\n | Card_Category   | Product Variable - Type of Card (Blue, Silver, Gold, Platinum)                                                                      |\n | Months_on_book  | Period of relationship with bank                                                                                                    |","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":606}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Spark ML для задачи оттока</h1>\n<p>Источник данных: <a href=\"https://www.kaggle.com/sakshigoyal7/credit-card-customers\">Kaggle</a></p>\n<p>Описания полей:</p>\n<table>\n<thead>\n<tr><th align=\"left\">Название</th><th align=\"left\">Описание</th></tr>\n</thead>\n<tbody>\n<tr><td align=\"left\">CLIENTNUM</td><td align=\"left\">Client number. Unique identifier for the customer holding the account</td></tr>\n<tr><td align=\"left\">Attrition_Flag</td><td align=\"left\">Internal event (customer activity) variable</td></tr>\n<tr><td align=\"left\">Customer_Age</td><td align=\"left\">Demographic variable - Customer&rsquo;s Age in Years</td></tr>\n<tr><td align=\"left\">Gender</td><td align=\"left\">Demographic variable - M=Male, F=Female</td></tr>\n<tr><td align=\"left\">Dependent_count</td><td align=\"left\">Demographic variable - Number of dependents</td></tr>\n<tr><td align=\"left\">Education_Level</td><td align=\"left\">Demographic variable - Educational Qualification of the account holder (example: high school, college graduate, etc.)</td></tr>\n<tr><td align=\"left\">Marital_Status</td><td align=\"left\">Demographic variable - Married, Single, Divorced, Unknown</td></tr>\n<tr><td align=\"left\">Income_Category</td><td align=\"left\">Demographic variable - Annual Income Category of the account holder (&lt; $40K, $40K - 60K, $60K - $80K, $80K-$120K, &gt; $120K, Unknown)</td></tr>\n<tr><td align=\"left\">Card_Category</td><td align=\"left\">Product Variable - Type of Card (Blue, Silver, Gold, Platinum)</td></tr>\n<tr><td align=\"left\">Months_on_book</td><td align=\"left\">Period of relationship with bank</td></tr>\n</tbody>\n</table>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776056_1185737253","id":"paragraph_1606837303847_1450294451","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","focus":true,"$$hashKey":"object:244"},{"title":"Загрузка и знакомство с данными","text":"%md\n## Загрузка и знакомство с данными","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":97},"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Загрузка и знакомство с данными</h2>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776057_546596784","id":"paragraph_1606839576154_1826987662","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:245"},{"text":"import org.apache.spark.sql.Dataset\n\nval raw = spark\n        .read\n        .option(\"header\", \"true\")\n        .option(\"inferSchema\", \"true\")\n        .csv(\"workspace/spark/SparkML/data/BankChurners.csv\")\n\nval columns: Array[String] = raw.columns\nval columnsLen: Int = columns.length\nval colsToDrop: Array[String] = columns.slice(columnsLen - 2, columnsLen) :+ columns.head\n\nval df = raw.drop(colsToDrop: _*)\n\ndf.show(5, truncate = false)","user":"anonymous","dateUpdated":"Oct 18, 2023, 2:00:22 PM","progress":100,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Attrition_Flag","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Customer_Age","index":1,"aggr":"avg"}],"setting":{"lineChart":{}}}}},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":288}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+\n|Attrition_Flag   |Customer_Age|Gender|Dependent_count|Education_Level|Marital_Status|Income_Category|Card_Category|Months_on_book|Total_Relationship_Count|Months_Inactive_12_mon|Contacts_Count_12_mon|Credit_Limit|Total_Revolving_Bal|Avg_Open_To_Buy|Total_Amt_Chng_Q4_Q1|Total_Trans_Amt|Total_Trans_Ct|Total_Ct_Chng_Q4_Q1|Avg_Utilization_Ratio|\n+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+\n|Existing Customer|45          |M     |3              |High School    |Married       |$60K - $80K    |Blue         |39            |5                       |1                     |3                    |12691.0     |777                |11914.0        |1.335               |1144           |42            |1.625              |0.061                |\n|Existing Customer|49          |F     |5              |Graduate       |Single        |Less than $40K |Blue         |44            |6                       |1                     |2                    |8256.0      |864                |7392.0         |1.541               |1291           |33            |3.714              |0.105                |\n|Existing Customer|51          |M     |3              |Graduate       |Married       |$80K - $120K   |Blue         |36            |4                       |1                     |0                    |3418.0      |0                  |3418.0         |2.594               |1887           |20            |2.333              |0.0                  |\n|Existing Customer|40          |F     |4              |High School    |Unknown       |Less than $40K |Blue         |34            |3                       |4                     |1                    |3313.0      |2517               |796.0          |1.405               |1171           |20            |2.333              |0.76                 |\n|Existing Customer|40          |M     |3              |Uneducated     |Married       |$60K - $80K    |Blue         |21            |5                       |1                     |0                    |4716.0      |0                  |4716.0         |2.175               |816            |28            |2.5                |0.0                  |\n+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+\nonly showing top 5 rows\n\nimport org.apache.spark.sql.Dataset\n\u001b[1m\u001b[34mraw\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [CLIENTNUM: int, Attrition_Flag: string ... 21 more fields]\n\u001b[1m\u001b[34mcolumns\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(CLIENTNUM, Attrition_Flag, Customer_Age, Gender, Dependent_count, Education_Level, Marital_Status, Income_Category, Card_Category, Months_on_book, Total_Relationship_Count, Months_Inactive_12_mon, Contacts_Count_12_mon, Credit_Limit, Total_Revolving_Bal, Avg_Open_To_Buy, Total_Amt_Chng_Q4_Q1, Total_Trans_Amt, Total_Trans_Ct, Total_Ct_Chng_Q4_Q1, Avg_Utilization_Ratio, Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_1, Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dep...\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=15"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=16"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=17"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776057_1728278988","id":"paragraph_1606751129635_1125684907","dateCreated":"Oct 18, 2023, 1:42:56 PM","dateStarted":"Oct 18, 2023, 1:53:17 PM","dateFinished":"Oct 18, 2023, 1:53:17 PM","status":"FINISHED","$$hashKey":"object:246"},{"title":"Определяем типы колонок","text":"%md\n### Определяем типы колонок","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Определяем типы колонок</h3>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776057_1380706215","id":"paragraph_1606925890931_70959983","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:247"},{"text":"df.printSchema","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:53:08 PM","progress":0,"config":{"lineNumbers":true,"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":654}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Attrition_Flag: string (nullable = true)\n |-- Customer_Age: integer (nullable = true)\n |-- Gender: string (nullable = true)\n |-- Dependent_count: integer (nullable = true)\n |-- Education_Level: string (nullable = true)\n |-- Marital_Status: string (nullable = true)\n |-- Income_Category: string (nullable = true)\n |-- Card_Category: string (nullable = true)\n |-- Months_on_book: integer (nullable = true)\n |-- Total_Relationship_Count: integer (nullable = true)\n |-- Months_Inactive_12_mon: integer (nullable = true)\n |-- Contacts_Count_12_mon: integer (nullable = true)\n |-- Credit_Limit: double (nullable = true)\n |-- Total_Revolving_Bal: integer (nullable = true)\n |-- Avg_Open_To_Buy: double (nullable = true)\n |-- Total_Amt_Chng_Q4_Q1: double (nullable = true)\n |-- Total_Trans_Amt: integer (nullable = true)\n |-- Total_Trans_Ct: integer (nullable = true)\n |-- Total_Ct_Chng_Q4_Q1: double (nullable = true)\n |-- Avg_Utilization_Ratio: double (nullable = true)\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776057_970436902","id":"paragraph_1606751161317_1444135048","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:248","dateStarted":"Oct 18, 2023, 1:53:16 PM","dateFinished":"Oct 18, 2023, 1:53:17 PM"},{"text":"df.dtypes.foreach { dt => println(f\"${dt._1}%25s\\t${dt._2}\") }","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:53:08 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":615}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"           Attrition_Flag\tStringType\n             Customer_Age\tIntegerType\n                   Gender\tStringType\n          Dependent_count\tIntegerType\n          Education_Level\tStringType\n           Marital_Status\tStringType\n          Income_Category\tStringType\n            Card_Category\tStringType\n           Months_on_book\tIntegerType\n Total_Relationship_Count\tIntegerType\n   Months_Inactive_12_mon\tIntegerType\n    Contacts_Count_12_mon\tIntegerType\n             Credit_Limit\tDoubleType\n      Total_Revolving_Bal\tIntegerType\n          Avg_Open_To_Buy\tDoubleType\n     Total_Amt_Chng_Q4_Q1\tDoubleType\n          Total_Trans_Amt\tIntegerType\n           Total_Trans_Ct\tIntegerType\n      Total_Ct_Chng_Q4_Q1\tDoubleType\n    Avg_Utilization_Ratio\tDoubleType\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776058_1594501383","id":"paragraph_1618420649753_253468186","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:249","dateStarted":"Oct 18, 2023, 1:53:12 PM","dateFinished":"Oct 18, 2023, 1:53:12 PM"},{"text":"df.dtypes.groupBy(_._2).mapValues(_.length).foreach(println)","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:53:08 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":161}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(StringType,6)\n(IntegerType,9)\n(DoubleType,5)\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776058_1908776173","id":"paragraph_1606751195914_1551178809","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:250","dateStarted":"Oct 18, 2023, 1:53:11 PM","dateFinished":"Oct 18, 2023, 1:53:12 PM"},{"title":"Проверяем числовые колонки","text":"%md\n### Проверим числовые колонки","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":96}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Проверим числовые колонки</h3>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776058_959960061","id":"paragraph_1606991896269_1700603131","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:251"},{"text":"val numericColumns: Array[String] = df.dtypes.filter(p => p._2.equals(\"DoubleType\") || p._2.equals(\"IntegerType\")).map(_._1)\ndf.select(numericColumns.map(col): _*).summary().show","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:53:08 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"summary","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Customer_Age","index":1,"aggr":"avg"}],"setting":{"lineChart":{}}}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":368}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------------+------------------+------------------+------------------------+----------------------+---------------------+-----------------+-------------------+-----------------+--------------------+-----------------+-----------------+-------------------+---------------------+\n|summary|     Customer_Age|   Dependent_count|    Months_on_book|Total_Relationship_Count|Months_Inactive_12_mon|Contacts_Count_12_mon|     Credit_Limit|Total_Revolving_Bal|  Avg_Open_To_Buy|Total_Amt_Chng_Q4_Q1|  Total_Trans_Amt|   Total_Trans_Ct|Total_Ct_Chng_Q4_Q1|Avg_Utilization_Ratio|\n+-------+-----------------+------------------+------------------+------------------------+----------------------+---------------------+-----------------+-------------------+-----------------+--------------------+-----------------+-----------------+-------------------+---------------------+\n|  count|            10127|             10127|             10127|                   10127|                 10127|                10127|            10127|              10127|            10127|               10127|            10127|            10127|              10127|                10127|\n|   mean|46.32596030413745|2.3462032191172115|35.928409203120374|      3.8125802310654686|    2.3411671768539546|   2.4553174681544387|8631.953698034848| 1162.8140614199665|7469.139636614887|  0.7599406536980376|4404.086303939963|64.85869457884863| 0.7122223758269962|   0.2748935518909845|\n| stddev|8.016814032549046|  1.29890834890379|  7.98641633087208|        1.55440786533883|    1.0106223994182844|   1.1062251426359249|9088.776650223148|  814.9873352357533|9090.685323679114|  0.2192067692307027|3397.129253557085|23.47257044923301|0.23808609133294137|  0.27569146925238736|\n|    min|               26|                 0|                13|                       1|                     0|                    0|           1438.3|                  0|              3.0|                 0.0|              510|               10|                0.0|                  0.0|\n|    25%|               41|                 1|                31|                       3|                     2|                    2|           2555.0|                357|           1322.0|               0.631|             2155|               45|              0.581|                0.022|\n|    50%|               46|                 2|                36|                       4|                     2|                    2|           4549.0|               1276|           3472.0|               0.736|             3899|               67|              0.702|                0.175|\n|    75%|               52|                 3|                40|                       5|                     3|                    3|          11067.0|               1784|           9857.0|               0.859|             4741|               81|              0.818|                0.503|\n|    max|               73|                 5|                56|                       6|                     6|                    6|          34516.0|               2517|          34516.0|               3.397|            18484|              139|              3.714|                0.999|\n+-------+-----------------+------------------+------------------+------------------------+----------------------+---------------------+-----------------+-------------------+-----------------+--------------------+-----------------+-----------------+-------------------+---------------------+\n\n\u001b[1m\u001b[34mnumericColumns\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(Customer_Age, Dependent_count, Months_on_book, Total_Relationship_Count, Months_Inactive_12_mon, Contacts_Count_12_mon, Credit_Limit, Total_Revolving_Bal, Avg_Open_To_Buy, Total_Amt_Chng_Q4_Q1, Total_Trans_Amt, Total_Trans_Ct, Total_Ct_Chng_Q4_Q1, Avg_Utilization_Ratio)\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=6"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=7"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776058_1159551849","id":"paragraph_1606991895236_1947910670","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:252","dateStarted":"Oct 18, 2023, 1:53:08 PM","dateFinished":"Oct 18, 2023, 1:53:11 PM"},{"text":"df.groupBy(\"Customer_Age\").count().orderBy(\"Customer_Age\").show(100)","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:53:08 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":[{"graph":{"mode":"scatterChart","height":300,"optionOpen":false,"keys":[{"name":"Customer_Age","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"avg"}],"setting":{"scatterChart":{"xAxis":{"name":"Customer_Age","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}},"multiBarChart":{},"pieChart":{},"stackedAreaChart":{},"lineChart":{}}}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":426}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----+\n|Customer_Age|count|\n+------------+-----+\n|          26|   78|\n|          27|   32|\n|          28|   29|\n|          29|   56|\n|          30|   70|\n|          31|   91|\n|          32|  106|\n|          33|  127|\n|          34|  146|\n|          35|  184|\n|          36|  221|\n|          37|  260|\n|          38|  303|\n|          39|  333|\n|          40|  361|\n|          41|  379|\n|          42|  426|\n|          43|  473|\n|          44|  500|\n|          45|  486|\n|          46|  490|\n|          47|  479|\n|          48|  472|\n|          49|  495|\n|          50|  452|\n|          51|  398|\n|          52|  376|\n|          53|  387|\n|          54|  307|\n|          55|  279|\n|          56|  262|\n|          57|  223|\n|          58|  157|\n|          59|  157|\n|          60|  127|\n|          61|   93|\n|          62|   93|\n|          63|   65|\n|          64|   43|\n|          65|  101|\n|          66|    2|\n|          67|    4|\n|          68|    2|\n|          70|    1|\n|          73|    1|\n+------------+-----+\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=9"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=10"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776058_1525771965","id":"paragraph_1606991960536_816866823","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:253","dateStarted":"Oct 18, 2023, 1:53:15 PM","dateFinished":"Oct 18, 2023, 1:53:16 PM"},{"title":"Целевая колонка","text":"%md\n## Целевая колонка","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Целевая колонка</h2>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776058_1257909085","id":"paragraph_1606991017829_504929987","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:254"},{"text":"val dft = df.withColumn(\"target\", when($\"Attrition_Flag\" === \"Existing Customer\", 0).otherwise(1))\n\ndft.select(\"Attrition_Flag\", \"target\").show(5, truncate = false)","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:53:08 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"target","index":20,"aggr":"sum"}],"groups":[],"values":[{"name":"Customer_Age","index":1,"aggr":"avg"}],"setting":{"lineChart":{}}}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":260}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+------+\n|Attrition_Flag   |target|\n+-----------------+------+\n|Existing Customer|0     |\n|Existing Customer|0     |\n|Existing Customer|0     |\n|Existing Customer|0     |\n|Existing Customer|0     |\n+-----------------+------+\nonly showing top 5 rows\n\n\u001b[1m\u001b[34mdft\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [Attrition_Flag: string, Customer_Age: int ... 19 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=8"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776058_121574514","id":"paragraph_1606991016670_1911789844","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:255","dateStarted":"Oct 18, 2023, 1:53:15 PM","dateFinished":"Oct 18, 2023, 1:53:15 PM"},{"title":"Проверка сбалансированности данных","text":"%md\n### Проверка сбалансированности данных","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":129}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Проверка сбалансированности данных</h3>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776059_802309667","id":"paragraph_1606991337105_1201040882","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:256"},{"text":"dft.groupBy(\"target\").count.show","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:54:16 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"target","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"avg"}],"setting":{"lineChart":{}}}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":169}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-----+\n|target|count|\n+------+-----+\n|     1| 1627|\n|     0| 8500|\n+------+-----+\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=18"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=19"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776059_1804343138","id":"paragraph_1606991348408_1872831577","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:257","dateStarted":"Oct 18, 2023, 1:54:16 PM","dateFinished":"Oct 18, 2023, 1:54:16 PM"},{"title":"Oversampling","text":"%md\n### Oversampling","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Oversampling</h3>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776059_1650543215","id":"paragraph_1606991539971_814941657","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:258"},{"text":"val df1 = dft.filter($\"target\" === 1)\nval df0 = dft.filter($\"target\" === 0)\n\nval df1count = df1.count\nval df0count = df0.count\n\ndf0count / df1count","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:54:24 PM","progress":50,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":218}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mdf1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [Attrition_Flag: string, Customer_Age: int ... 19 more fields]\n\u001b[1m\u001b[34mdf0\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [Attrition_Flag: string, Customer_Age: int ... 19 more fields]\n\u001b[1m\u001b[34mdf1count\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 1627\n\u001b[1m\u001b[34mdf0count\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 8500\n\u001b[1m\u001b[34mres111\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 5\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=20"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=21"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=22"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=23"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776059_2054623459","id":"paragraph_1606991549829_626942384","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:259","dateStarted":"Oct 18, 2023, 1:54:24 PM","dateFinished":"Oct 18, 2023, 1:54:24 PM"},{"id":"paragraph_1697627180595_1429316936","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"val overArray = (1 to (df0count / df1count).toInt).toArray","user":"anonymous","dateUpdated":"Oct 18, 2023, 2:07:00 PM","progress":0,"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697627180595_1429316936","dateCreated":"Oct 18, 2023, 2:06:20 PM","status":"FINISHED","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34moverArray\u001b[0m: \u001b[1m\u001b[32mArray[Int]\u001b[0m = Array(1, 2, 3, 4, 5)\n"}]},"dateStarted":"Oct 18, 2023, 2:07:00 PM","dateFinished":"Oct 18, 2023, 2:07:00 PM"},{"id":"paragraph_1697627111361_1283457413","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"<console>:60: \u001b[31merror: \u001b[0mnot found: type Explode\n       #### Вариант 1: Explode\n                       ^\n<console>:60: \u001b[31merror: \u001b[0mnot found: value ####\n       #### Вариант 1: Explode\n       ^\n"}]},"text":"#### Вариант 1: Explode","user":"anonymous","dateUpdated":"Oct 18, 2023, 2:05:11 PM","progress":0,"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697627111361_1283457413","dateCreated":"Oct 18, 2023, 2:05:11 PM","dateStarted":"Oct 18, 2023, 2:05:11 PM","dateFinished":"Oct 18, 2023, 2:05:11 PM","status":"ERROR"},{"id":"paragraph_1697627152500_836942970","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"df1.withColumn(\"dummy\", lit(overArray)).show(10, truncate = false)","user":"anonymous","dateUpdated":"Oct 18, 2023, 2:07:24 PM","progress":0,"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697627152500_836942970","dateCreated":"Oct 18, 2023, 2:05:52 PM","status":"FINISHED","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+---------------+\n|Attrition_Flag   |Customer_Age|Gender|Dependent_count|Education_Level|Marital_Status|Income_Category|Card_Category|Months_on_book|Total_Relationship_Count|Months_Inactive_12_mon|Contacts_Count_12_mon|Credit_Limit|Total_Revolving_Bal|Avg_Open_To_Buy|Total_Amt_Chng_Q4_Q1|Total_Trans_Amt|Total_Trans_Ct|Total_Ct_Chng_Q4_Q1|Avg_Utilization_Ratio|target|dummy          |\n+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+---------------+\n|Attrited Customer|62          |F     |0              |Graduate       |Married       |Less than $40K |Blue         |49            |2                       |3                     |3                    |1438.3      |0                  |1438.3         |1.047               |692            |16            |0.6                |0.0                  |1     |[1, 2, 3, 4, 5]|\n|Attrited Customer|66          |F     |0              |Doctorate      |Married       |Unknown        |Blue         |56            |5                       |4                     |3                    |7882.0      |605                |7277.0         |1.052               |704            |16            |0.143              |0.077                |1     |[1, 2, 3, 4, 5]|\n|Attrited Customer|54          |F     |1              |Graduate       |Married       |Less than $40K |Blue         |40            |2                       |3                     |1                    |1438.3      |808                |630.3          |0.997               |705            |19            |0.9                |0.562                |1     |[1, 2, 3, 4, 5]|\n|Attrited Customer|56          |M     |2              |Graduate       |Married       |$120K +        |Blue         |36            |1                       |3                     |3                    |15769.0     |0                  |15769.0        |1.041               |602            |15            |0.364              |0.0                  |1     |[1, 2, 3, 4, 5]|\n|Attrited Customer|48          |M     |2              |Graduate       |Married       |$60K - $80K    |Silver       |35            |2                       |4                     |4                    |34516.0     |0                  |34516.0        |0.763               |691            |15            |0.5                |0.0                  |1     |[1, 2, 3, 4, 5]|\n|Attrited Customer|55          |F     |4              |Unknown        |Married       |$40K - $60K    |Blue         |45            |2                       |4                     |3                    |2158.0      |0                  |2158.0         |0.585               |615            |12            |0.714              |0.0                  |1     |[1, 2, 3, 4, 5]|\n|Attrited Customer|47          |M     |2              |Unknown        |Married       |$80K - $120K   |Blue         |37            |2                       |3                     |3                    |5449.0      |1628               |3821.0         |0.696               |836            |18            |0.385              |0.299                |1     |[1, 2, 3, 4, 5]|\n|Attrited Customer|53          |M     |2              |Graduate       |Married       |$80K - $120K   |Blue         |41            |3                       |3                     |2                    |11669.0     |2227               |9442.0         |0.622               |720            |23            |0.353              |0.191                |1     |[1, 2, 3, 4, 5]|\n|Attrited Customer|48          |F     |5              |High School    |Married       |Less than $40K |Blue         |38            |1                       |3                     |3                    |8025.0      |0                  |8025.0         |0.654               |673            |18            |0.8                |0.0                  |1     |[1, 2, 3, 4, 5]|\n|Attrited Customer|59          |M     |1              |College        |Single        |$60K - $80K    |Blue         |53            |2                       |3                     |3                    |14979.0     |0                  |14979.0        |0.71                |530            |10            |1.0                |0.0                  |1     |[1, 2, 3, 4, 5]|\n+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+---------------+\nonly showing top 10 rows\n\n"}]},"dateStarted":"Oct 18, 2023, 2:07:24 PM","dateFinished":"Oct 18, 2023, 2:07:24 PM"},{"text":"df1.withColumn(\"dummy\", explode(lit(overArray))).show(10, truncate = false)","user":"anonymous","dateUpdated":"Oct 18, 2023, 2:07:56 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":257}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+-----+\n|Attrition_Flag   |Customer_Age|Gender|Dependent_count|Education_Level|Marital_Status|Income_Category|Card_Category|Months_on_book|Total_Relationship_Count|Months_Inactive_12_mon|Contacts_Count_12_mon|Credit_Limit|Total_Revolving_Bal|Avg_Open_To_Buy|Total_Amt_Chng_Q4_Q1|Total_Trans_Amt|Total_Trans_Ct|Total_Ct_Chng_Q4_Q1|Avg_Utilization_Ratio|target|dummy|\n+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+-----+\n|Attrited Customer|62          |F     |0              |Graduate       |Married       |Less than $40K |Blue         |49            |2                       |3                     |3                    |1438.3      |0                  |1438.3         |1.047               |692            |16            |0.6                |0.0                  |1     |1    |\n|Attrited Customer|62          |F     |0              |Graduate       |Married       |Less than $40K |Blue         |49            |2                       |3                     |3                    |1438.3      |0                  |1438.3         |1.047               |692            |16            |0.6                |0.0                  |1     |2    |\n|Attrited Customer|62          |F     |0              |Graduate       |Married       |Less than $40K |Blue         |49            |2                       |3                     |3                    |1438.3      |0                  |1438.3         |1.047               |692            |16            |0.6                |0.0                  |1     |3    |\n|Attrited Customer|62          |F     |0              |Graduate       |Married       |Less than $40K |Blue         |49            |2                       |3                     |3                    |1438.3      |0                  |1438.3         |1.047               |692            |16            |0.6                |0.0                  |1     |4    |\n|Attrited Customer|62          |F     |0              |Graduate       |Married       |Less than $40K |Blue         |49            |2                       |3                     |3                    |1438.3      |0                  |1438.3         |1.047               |692            |16            |0.6                |0.0                  |1     |5    |\n|Attrited Customer|66          |F     |0              |Doctorate      |Married       |Unknown        |Blue         |56            |5                       |4                     |3                    |7882.0      |605                |7277.0         |1.052               |704            |16            |0.143              |0.077                |1     |1    |\n|Attrited Customer|66          |F     |0              |Doctorate      |Married       |Unknown        |Blue         |56            |5                       |4                     |3                    |7882.0      |605                |7277.0         |1.052               |704            |16            |0.143              |0.077                |1     |2    |\n|Attrited Customer|66          |F     |0              |Doctorate      |Married       |Unknown        |Blue         |56            |5                       |4                     |3                    |7882.0      |605                |7277.0         |1.052               |704            |16            |0.143              |0.077                |1     |3    |\n|Attrited Customer|66          |F     |0              |Doctorate      |Married       |Unknown        |Blue         |56            |5                       |4                     |3                    |7882.0      |605                |7277.0         |1.052               |704            |16            |0.143              |0.077                |1     |4    |\n|Attrited Customer|66          |F     |0              |Doctorate      |Married       |Unknown        |Blue         |56            |5                       |4                     |3                    |7882.0      |605                |7277.0         |1.052               |704            |16            |0.143              |0.077                |1     |5    |\n+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+-----+\nonly showing top 10 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776059_423630295","id":"paragraph_1677000437979_1366608706","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:260","dateStarted":"Oct 18, 2023, 2:07:56 PM","dateFinished":"Oct 18, 2023, 2:07:56 PM"},{"text":"val df1Over = df1\n        .withColumn(\"dummy\", explode(lit((1 to (df0count / df1count).toInt).toArray)))\n        .drop(\"dummy\")\n\ndf1Over.show(10, truncate = false)","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:54:34 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Customer_Age","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"Dependent_count","index":3,"aggr":"avg"}],"setting":{"lineChart":{}}}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":432}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+\n|Attrition_Flag   |Customer_Age|Gender|Dependent_count|Education_Level|Marital_Status|Income_Category|Card_Category|Months_on_book|Total_Relationship_Count|Months_Inactive_12_mon|Contacts_Count_12_mon|Credit_Limit|Total_Revolving_Bal|Avg_Open_To_Buy|Total_Amt_Chng_Q4_Q1|Total_Trans_Amt|Total_Trans_Ct|Total_Ct_Chng_Q4_Q1|Avg_Utilization_Ratio|target|\n+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+\n|Attrited Customer|62          |F     |0              |Graduate       |Married       |Less than $40K |Blue         |49            |2                       |3                     |3                    |1438.3      |0                  |1438.3         |1.047               |692            |16            |0.6                |0.0                  |1     |\n|Attrited Customer|62          |F     |0              |Graduate       |Married       |Less than $40K |Blue         |49            |2                       |3                     |3                    |1438.3      |0                  |1438.3         |1.047               |692            |16            |0.6                |0.0                  |1     |\n|Attrited Customer|62          |F     |0              |Graduate       |Married       |Less than $40K |Blue         |49            |2                       |3                     |3                    |1438.3      |0                  |1438.3         |1.047               |692            |16            |0.6                |0.0                  |1     |\n|Attrited Customer|62          |F     |0              |Graduate       |Married       |Less than $40K |Blue         |49            |2                       |3                     |3                    |1438.3      |0                  |1438.3         |1.047               |692            |16            |0.6                |0.0                  |1     |\n|Attrited Customer|62          |F     |0              |Graduate       |Married       |Less than $40K |Blue         |49            |2                       |3                     |3                    |1438.3      |0                  |1438.3         |1.047               |692            |16            |0.6                |0.0                  |1     |\n|Attrited Customer|66          |F     |0              |Doctorate      |Married       |Unknown        |Blue         |56            |5                       |4                     |3                    |7882.0      |605                |7277.0         |1.052               |704            |16            |0.143              |0.077                |1     |\n|Attrited Customer|66          |F     |0              |Doctorate      |Married       |Unknown        |Blue         |56            |5                       |4                     |3                    |7882.0      |605                |7277.0         |1.052               |704            |16            |0.143              |0.077                |1     |\n|Attrited Customer|66          |F     |0              |Doctorate      |Married       |Unknown        |Blue         |56            |5                       |4                     |3                    |7882.0      |605                |7277.0         |1.052               |704            |16            |0.143              |0.077                |1     |\n|Attrited Customer|66          |F     |0              |Doctorate      |Married       |Unknown        |Blue         |56            |5                       |4                     |3                    |7882.0      |605                |7277.0         |1.052               |704            |16            |0.143              |0.077                |1     |\n|Attrited Customer|66          |F     |0              |Doctorate      |Married       |Unknown        |Blue         |56            |5                       |4                     |3                    |7882.0      |605                |7277.0         |1.052               |704            |16            |0.143              |0.077                |1     |\n+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+\nonly showing top 10 rows\n\n\u001b[1m\u001b[34mdf1Over\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [Attrition_Flag: string, Customer_Age: int ... 19 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=25"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776059_2126572034","id":"paragraph_1606991673231_1004518248","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:261","dateStarted":"Oct 18, 2023, 1:54:36 PM","dateFinished":"Oct 18, 2023, 1:54:36 PM"},{"id":"paragraph_1697627316061_677860107","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"<console>:60: \u001b[31merror: \u001b[0mnot found: type Union\n       #### Вариант 2: Union\n                       ^\n<console>:60: \u001b[31merror: \u001b[0mnot found: value ####\n       #### Вариант 2: Union\n       ^\n"}]},"text":"#### Вариант 2: Union","user":"anonymous","dateUpdated":"Oct 18, 2023, 2:08:36 PM","progress":0,"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697627316061_677860107","dateCreated":"Oct 18, 2023, 2:08:36 PM","dateStarted":"Oct 18, 2023, 2:08:36 PM","dateFinished":"Oct 18, 2023, 2:08:36 PM","status":"ERROR"},{"id":"paragraph_1697627327109_1304144337","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"val df1Over2 = overArray.map { a => df1 }.reduce((x, y) => x unionAll y)","user":"anonymous","dateUpdated":"Oct 18, 2023, 2:10:56 PM","progress":0,"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697627327109_1304144337","dateCreated":"Oct 18, 2023, 2:08:47 PM","status":"FINISHED","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mdf1Over2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [Attrition_Flag: string, Customer_Age: int ... 19 more fields]\n"}]},"dateStarted":"Oct 18, 2023, 2:10:56 PM","dateFinished":"Oct 18, 2023, 2:10:56 PM"},{"id":"paragraph_1697627648099_122829959","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"<console>:60: \u001b[31merror: \u001b[0mnot found: value ####\n       #### Проверяем\n       ^\n"}]},"text":"#### Проверяем","user":"anonymous","dateUpdated":"Oct 18, 2023, 2:14:08 PM","progress":0,"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697627648099_122829959","dateCreated":"Oct 18, 2023, 2:14:08 PM","dateStarted":"Oct 18, 2023, 2:14:08 PM","dateFinished":"Oct 18, 2023, 2:14:08 PM","status":"ERROR"},{"id":"paragraph_1697627487602_1315872718","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"df1Over.exceptAll(df1Over2).show","user":"anonymous","dateUpdated":"Oct 18, 2023, 2:13:31 PM","progress":0,"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697627487602_1315872718","dateCreated":"Oct 18, 2023, 2:11:27 PM","status":"FINISHED","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+\n|Attrition_Flag|Customer_Age|Gender|Dependent_count|Education_Level|Marital_Status|Income_Category|Card_Category|Months_on_book|Total_Relationship_Count|Months_Inactive_12_mon|Contacts_Count_12_mon|Credit_Limit|Total_Revolving_Bal|Avg_Open_To_Buy|Total_Amt_Chng_Q4_Q1|Total_Trans_Amt|Total_Trans_Ct|Total_Ct_Chng_Q4_Q1|Avg_Utilization_Ratio|target|\n+--------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+\n+--------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+\n\n"}]},"dateStarted":"Oct 18, 2023, 2:13:31 PM","dateFinished":"Oct 18, 2023, 2:13:31 PM"},{"id":"paragraph_1697627666163_1725655654","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"<console>:60: \u001b[31merror: \u001b[0mnot found: value ####\n       #### Объединяем\n       ^\n"}]},"text":"#### Объединяем","user":"anonymous","dateUpdated":"Oct 18, 2023, 2:14:26 PM","progress":0,"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697627666163_1725655654","dateCreated":"Oct 18, 2023, 2:14:26 PM","dateStarted":"Oct 18, 2023, 2:14:26 PM","dateFinished":"Oct 18, 2023, 2:14:26 PM","status":"ERROR"},{"text":"val data = df0.unionAll(df1Over)\ndata.groupBy(\"target\").count.show","user":"anonymous","dateUpdated":"Oct 18, 2023, 2:01:30 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"target","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"avg"}],"setting":{"lineChart":{}}}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":156}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-----+\n|target|count|\n+------+-----+\n|     0| 8500|\n|     1| 8135|\n+------+-----+\n\n\u001b[1m\u001b[34mdata\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [Attrition_Flag: string, Customer_Age: int ... 19 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=956"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=957"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776059_567691132","id":"paragraph_1606992124282_554905533","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:262","dateStarted":"Oct 18, 2023, 2:01:30 PM","dateFinished":"Oct 18, 2023, 2:01:31 PM"},{"title":"Работа с признаками","text":"%md\n## Работа с признаками","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Работа с признаками</h2>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776059_756101884","id":"paragraph_1606939789058_1978961512","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:263"},{"title":"Проверим корреляции числовых признаков","text":"%md\n### Проверим корреляции числовых признаков","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":122}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Проверим корреляции числовых признаков</h3>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776060_1446755771","id":"paragraph_1606938312478_872925491","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:264"},{"text":"val numericColumnsPairs = numericColumns.flatMap(f1 => numericColumns.map(f2 => (f1, f2)))","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:54:34 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":240}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mnumericColumnsPairs\u001b[0m: \u001b[1m\u001b[32mArray[(String, String)]\u001b[0m = Array((Customer_Age,Customer_Age), (Customer_Age,Dependent_count), (Customer_Age,Months_on_book), (Customer_Age,Total_Relationship_Count), (Customer_Age,Months_Inactive_12_mon), (Customer_Age,Contacts_Count_12_mon), (Customer_Age,Credit_Limit), (Customer_Age,Total_Revolving_Bal), (Customer_Age,Avg_Open_To_Buy), (Customer_Age,Total_Amt_Chng_Q4_Q1), (Customer_Age,Total_Trans_Amt), (Customer_Age,Total_Trans_Ct), (Customer_Age,Total_Ct_Chng_Q4_Q1), (Customer_Age,Avg_Utilization_Ratio), (Dependent_count,Customer_Age), (Dependent_count,Dependent_count), (Dependent_count,Months_on_book), (Dependent_count,Total_Relationship_Count), (Dependent_count,Months_Inactive_12_mon), (Dependent_count,Contacts_Count_12_mon), (Dependen...\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776060_319459870","id":"paragraph_1618421674477_540266497","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:265","dateStarted":"Oct 18, 2023, 1:54:36 PM","dateFinished":"Oct 18, 2023, 1:54:37 PM"},{"text":"for {\n  x <- numericColumns\n  y <- numericColumns\n} yield (x, y)","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:54:34 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":234}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mres115\u001b[0m: \u001b[1m\u001b[32mArray[(String, String)]\u001b[0m = Array((Customer_Age,Customer_Age), (Customer_Age,Dependent_count), (Customer_Age,Months_on_book), (Customer_Age,Total_Relationship_Count), (Customer_Age,Months_Inactive_12_mon), (Customer_Age,Contacts_Count_12_mon), (Customer_Age,Credit_Limit), (Customer_Age,Total_Revolving_Bal), (Customer_Age,Avg_Open_To_Buy), (Customer_Age,Total_Amt_Chng_Q4_Q1), (Customer_Age,Total_Trans_Amt), (Customer_Age,Total_Trans_Ct), (Customer_Age,Total_Ct_Chng_Q4_Q1), (Customer_Age,Avg_Utilization_Ratio), (Dependent_count,Customer_Age), (Dependent_count,Dependent_count), (Dependent_count,Months_on_book), (Dependent_count,Total_Relationship_Count), (Dependent_count,Months_Inactive_12_mon), (Dependent_count,Contacts_Count_12_mon), (Dependent_count,Credi...\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776060_590095356","id":"paragraph_1620388665745_1543146524","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:266","dateStarted":"Oct 18, 2023, 1:54:36 PM","dateFinished":"Oct 18, 2023, 1:54:36 PM"},{"text":"%md\n#### Вариант 1: DataFrameStatFunctions","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorHide":false,"fontSize":9,"results":{},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Вариант 1: DataFrameStatFunctions</h4>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776060_1160831396","id":"paragraph_1620388606314_402228463","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:267"},{"text":"val pairs = numericColumnsPairs\n        .filter { p => !p._1.equals(p._2) }\n        .map { p => if (p._1 < p._2) (p._1, p._2) else (p._2, p._1) }\n        .distinct\n\nval corr = pairs\n        .map { p => (p._1, p._2, data.stat.corr(p._1, p._2)) }\n        .filter(p => math.abs(p._3) > 0.6)","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:54:34 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":233}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mpairs\u001b[0m: \u001b[1m\u001b[32mArray[(String, String)]\u001b[0m = Array((Customer_Age,Dependent_count), (Customer_Age,Months_on_book), (Customer_Age,Total_Relationship_Count), (Customer_Age,Months_Inactive_12_mon), (Contacts_Count_12_mon,Customer_Age), (Credit_Limit,Customer_Age), (Customer_Age,Total_Revolving_Bal), (Avg_Open_To_Buy,Customer_Age), (Customer_Age,Total_Amt_Chng_Q4_Q1), (Customer_Age,Total_Trans_Amt), (Customer_Age,Total_Trans_Ct), (Customer_Age,Total_Ct_Chng_Q4_Q1), (Avg_Utilization_Ratio,Customer_Age), (Dependent_count,Months_on_book), (Dependent_count,Total_Relationship_Count), (Dependent_count,Months_Inactive_12_mon), (Contacts_Count_12_mon,Dependent_count), (Credit_Limit,Dependent_count), (Dependent_count,Total_Revolving_Bal), (Avg_Open_To_Buy,Dependent_count), (Dependent_co...\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=29"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=30"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=31"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=32"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=33"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=34"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=35"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=36"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=37"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=38"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=39"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=40"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=41"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=42"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=43"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=44"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=45"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=46"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=47"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=48"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=49"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=50"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=51"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=52"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=53"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=54"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=55"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=56"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=57"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=58"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=59"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=60"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=61"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=62"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=63"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=64"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=65"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=66"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=67"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=68"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=69"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=70"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=71"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=72"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=73"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=74"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=75"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=76"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=77"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=78"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=79"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=80"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=81"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=82"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=83"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=84"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=85"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=86"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=87"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=88"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=89"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=90"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=91"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=92"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=93"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=94"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=95"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=96"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=97"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=98"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=99"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=100"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=101"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=102"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=103"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=104"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=105"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=106"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=107"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=108"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=109"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=110"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=111"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=112"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=113"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=114"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=115"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=116"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=117"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=118"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=119"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=120"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=121"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=122"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=123"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=124"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=125"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=126"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=127"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=128"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=129"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=130"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=131"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=132"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=133"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=134"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=135"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=136"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=137"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=138"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=139"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=140"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=141"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=142"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=143"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=144"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=145"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=146"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=147"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=148"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=149"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=150"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=151"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=152"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=153"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=154"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=155"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=156"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=157"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=158"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=159"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=160"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=161"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=162"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=163"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=164"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=165"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=166"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=167"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=168"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=169"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=170"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=171"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=172"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=173"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=174"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=175"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=176"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=177"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=178"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=179"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=180"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=181"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=182"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=183"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=184"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=185"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=186"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=187"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=188"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=189"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=190"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=191"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=192"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=193"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=194"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=195"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=196"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=197"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=198"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=199"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=200"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=201"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=202"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=203"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=204"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=205"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=206"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=207"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=208"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=209"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=210"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776060_1317168602","id":"paragraph_1606939323647_314014139","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:268","dateStarted":"Oct 18, 2023, 1:54:37 PM","dateFinished":"Oct 18, 2023, 1:54:52 PM"},{"text":"corr.sortBy(_._3).reverse.foreach { c => println(f\"${c._1}%25s${c._2}%25s\\t${c._3}\") }","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:55:10 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":184}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"          Avg_Open_To_Buy             Credit_Limit\t0.9952040726156252\n          Total_Trans_Amt           Total_Trans_Ct\t0.8053901681243807\n             Customer_Age           Months_on_book\t0.7805047706891143\n    Avg_Utilization_Ratio      Total_Revolving_Bal\t0.6946855441968229\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776060_348351170","id":"paragraph_1606938967050_368597473","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:269","dateStarted":"Oct 18, 2023, 1:55:12 PM","dateFinished":"Oct 18, 2023, 1:55:12 PM"},{"text":"%md\n#### Вариант 2: Correlation","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorHide":false,"fontSize":9,"results":{},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Вариант 2: Correlation</h4>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776061_1050100394","id":"paragraph_1620387076382_1779220121","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:270"},{"text":"import org.apache.spark.ml.feature.VectorAssembler\nimport org.apache.spark.ml.stat.Correlation\nimport org.apache.spark.ml.linalg.Matrix\nimport org.apache.spark.sql.Row\n\nval numericAssembler = new VectorAssembler()\n  .setInputCols(numericColumns)\n  .setOutputCol(\"features\")\n\nval numeric = numericAssembler.transform(data)\nval Row(matrix: Matrix) = Correlation.corr(numeric, \"features\").head","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:55:10 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":[{"mode":"table","graph":{"mode":"table","height":300,"optionOpen":false}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":403}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.feature.VectorAssembler\nimport org.apache.spark.ml.stat.Correlation\nimport org.apache.spark.ml.linalg.Matrix\nimport org.apache.spark.sql.Row\n\u001b[1m\u001b[34mnumericAssembler\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.VectorAssembler\u001b[0m = VectorAssembler: uid=vecAssembler_2905a313c1f3, handleInvalid=error, numInputCols=14\n\u001b[1m\u001b[34mnumeric\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [Attrition_Flag: string, Customer_Age: int ... 20 more fields]\n\u001b[1m\u001b[34mmatrix\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.linalg.Matrix\u001b[0m =\n1.0                    -0.13575515707704905   ... (14 total)\n-0.13575515707704905   1.0                    ...\n0.780504770689084      -0.11728062823959522   ...\n-0.026525310066416643  -0.032664177863511015  ...\n0.13116552936201348    -0.0106575011505989...\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=219"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=220"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=221"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=222"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776061_687104192","id":"paragraph_1620387092231_5102501","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:271","dateStarted":"Oct 18, 2023, 1:55:13 PM","dateFinished":"Oct 18, 2023, 1:55:16 PM"},{"text":"val corr2 = matrix.toArray\n        .zip(numericColumnsPairs)\n        .map(cnn => (cnn._2._1, cnn._2._2, cnn._1))\n        .filter(p => math.abs(p._3) > 0.6 && p._3 < 1.0)\n        .map { p => if (p._1 < p._2) (p._1, p._2, p._3) else (p._2, p._1, p._3) }\n        .distinct","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:55:10 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":[{"mode":"table","graph":{"mode":"table","height":300,"optionOpen":false}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":135}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mcorr2\u001b[0m: \u001b[1m\u001b[32mArray[(String, String, Double)]\u001b[0m = Array((Customer_Age,Months_on_book,0.780504770689084), (Avg_Open_To_Buy,Credit_Limit,0.9952040726156179), (Avg_Utilization_Ratio,Total_Revolving_Bal,0.6946855441968222), (Total_Trans_Amt,Total_Trans_Ct,0.8053901681243786))\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776061_556278371","id":"paragraph_1620387401419_143938779","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:272","dateStarted":"Oct 18, 2023, 1:55:14 PM","dateFinished":"Oct 18, 2023, 1:55:16 PM"},{"text":"corr2.sortBy(_._3).reverse.foreach { c => println(f\"${c._1}%25s${c._2}%25s\\t${c._3}\") }","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:55:23 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":190}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"          Avg_Open_To_Buy             Credit_Limit\t0.9952040726156179\n          Total_Trans_Amt           Total_Trans_Ct\t0.8053901681243786\n             Customer_Age           Months_on_book\t0.780504770689084\n    Avg_Utilization_Ratio      Total_Revolving_Bal\t0.6946855441968222\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776061_1472938816","id":"paragraph_1620388416655_1172611382","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:273","dateStarted":"Oct 18, 2023, 1:55:23 PM","dateFinished":"Oct 18, 2023, 1:55:23 PM"},{"text":"corr.toSet.intersect(corr2.toSet)","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:55:26 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":106}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mres118\u001b[0m: \u001b[1m\u001b[32mscala.collection.immutable.Set[(String, String, Double)]\u001b[0m = Set()\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776061_1581624467","id":"paragraph_1620388443009_220515762","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:274","dateStarted":"Oct 18, 2023, 1:55:26 PM","dateFinished":"Oct 18, 2023, 1:55:26 PM"},{"text":"%md\n#### Оставляем числовые колонки с низкой кореляцией","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Оставляем числовые колонки с низкой кореляцией</h4>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776061_612193464","id":"paragraph_1657549969945_908690787","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:275"},{"text":"val numericColumnsFinal = numericColumns.diff(corr.map(_._2))","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:55:32 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":136}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mnumericColumnsFinal\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(Customer_Age, Dependent_count, Total_Relationship_Count, Months_Inactive_12_mon, Contacts_Count_12_mon, Avg_Open_To_Buy, Total_Amt_Chng_Q4_Q1, Total_Trans_Amt, Total_Ct_Chng_Q4_Q1, Avg_Utilization_Ratio)\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776061_284752249","id":"paragraph_1606940261003_2091911483","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:276","dateStarted":"Oct 18, 2023, 1:55:32 PM","dateFinished":"Oct 18, 2023, 1:55:32 PM"},{"title":"Категориальные признаки","text":"%md\n### Категориальные признаки","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Категориальные признаки</h3>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776061_512755564","id":"paragraph_1607074496354_317509656","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:277"},{"title":"Индексируем строковые колонки","text":"%md\n#### Индексируем строковые колонки","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Индексируем строковые колонки</h4>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776062_1903639154","id":"paragraph_1606925278873_1729512302","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:278"},{"text":"import org.apache.spark.ml.feature.StringIndexer\n\nval stringColumns = data\n        .dtypes\n        .filter(_._2.equals(\"StringType\"))\n        .map(_._1)\n        .filter(!_.equals(\"Attrition_Flag\"))\n\nval stringColumnsIndexed = stringColumns.map(_ + \"_Indexed\")\n\nval indexer = new StringIndexer()\n        .setInputCols(stringColumns)\n        .setOutputCols(stringColumnsIndexed)\n\nval indexed = indexer.fit(data).transform(data)\nindexed.show(5)","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:55:36 PM","progress":33,"config":{"lineNumbers":true,"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"target","index":20,"aggr":"sum"}],"groups":[],"values":[{"name":"Customer_Age","index":1,"aggr":"avg"}],"setting":{"lineChart":{}}}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":270}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+--------------+-----------------------+----------------------+-----------------------+---------------------+\n|   Attrition_Flag|Customer_Age|Gender|Dependent_count|Education_Level|Marital_Status|Income_Category|Card_Category|Months_on_book|Total_Relationship_Count|Months_Inactive_12_mon|Contacts_Count_12_mon|Credit_Limit|Total_Revolving_Bal|Avg_Open_To_Buy|Total_Amt_Chng_Q4_Q1|Total_Trans_Amt|Total_Trans_Ct|Total_Ct_Chng_Q4_Q1|Avg_Utilization_Ratio|target|Gender_Indexed|Education_Level_Indexed|Marital_Status_Indexed|Income_Category_Indexed|Card_Category_Indexed|\n+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+--------------+-----------------------+----------------------+-----------------------+---------------------+\n|Existing Customer|          45|     M|              3|    High School|       Married|    $60K - $80K|         Blue|            39|                       5|                     1|                    3|     12691.0|                777|        11914.0|               1.335|           1144|            42|              1.625|                0.061|     0|           1.0|                    1.0|                   0.0|                    3.0|                  0.0|\n|Existing Customer|          49|     F|              5|       Graduate|        Single| Less than $40K|         Blue|            44|                       6|                     1|                    2|      8256.0|                864|         7392.0|               1.541|           1291|            33|              3.714|                0.105|     0|           0.0|                    0.0|                   1.0|                    0.0|                  0.0|\n|Existing Customer|          51|     M|              3|       Graduate|       Married|   $80K - $120K|         Blue|            36|                       4|                     1|                    0|      3418.0|                  0|         3418.0|               2.594|           1887|            20|              2.333|                  0.0|     0|           1.0|                    0.0|                   0.0|                    2.0|                  0.0|\n|Existing Customer|          40|     F|              4|    High School|       Unknown| Less than $40K|         Blue|            34|                       3|                     4|                    1|      3313.0|               2517|          796.0|               1.405|           1171|            20|              2.333|                 0.76|     0|           0.0|                    1.0|                   2.0|                    0.0|                  0.0|\n|Existing Customer|          40|     M|              3|     Uneducated|       Married|    $60K - $80K|         Blue|            21|                       5|                     1|                    0|      4716.0|                  0|         4716.0|               2.175|            816|            28|                2.5|                  0.0|     0|           1.0|                    3.0|                   0.0|                    3.0|                  0.0|\n+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+--------------+-----------------------+----------------------+-----------------------+---------------------+\nonly showing top 5 rows\n\nimport org.apache.spark.ml.feature.StringIndexer\n\u001b[1m\u001b[34mstringColumns\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(Gender, Education_Level, Marital_Status, Income_Category, Card_Category)\n\u001b[1m\u001b[34mstringColumnsIndexed\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(Gender_Indexed, Education_Level_Indexed, Marital_Status_Indexed, Income_Category_Indexed, Card_Category_Indexed)\n\u001b[1m\u001b[34mindexer\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.StringIndexer\u001b[0m = strIdx_4bcba3eea624\n\u001b[1m\u001b[34mindexed\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [Attrition_Flag: string, Customer_Age: int ... 24 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=223"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=224"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=225"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776062_2117171086","id":"paragraph_1606929243578_1243967132","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:279","dateStarted":"Oct 18, 2023, 1:55:36 PM","dateFinished":"Oct 18, 2023, 1:55:36 PM"},{"title":"Кодируем категориальные признаки","text":"%md\n#### Кодируем категориальные признаки","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Кодируем категориальные признаки</h4>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776062_714552000","id":"paragraph_1606935270662_2098121105","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:280"},{"text":"import org.apache.spark.ml.feature.OneHotEncoder\n\nval catColumns = stringColumnsIndexed.map(_ + \"_Coded\")\n    \nval encoder = new OneHotEncoder()\n        .setInputCols(stringColumnsIndexed)\n        .setOutputCols(catColumns)\n\nval encoded = encoder.fit(indexed).transform(indexed)\nencoded.show(5)","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:55:40 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"target","index":20,"aggr":"sum"}],"groups":[],"values":[{"name":"Customer_Age","index":1,"aggr":"avg"}],"setting":{"lineChart":{}}}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":261}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+--------------+-----------------------+----------------------+-----------------------+---------------------+--------------------+-----------------------------+----------------------------+-----------------------------+---------------------------+\n|   Attrition_Flag|Customer_Age|Gender|Dependent_count|Education_Level|Marital_Status|Income_Category|Card_Category|Months_on_book|Total_Relationship_Count|Months_Inactive_12_mon|Contacts_Count_12_mon|Credit_Limit|Total_Revolving_Bal|Avg_Open_To_Buy|Total_Amt_Chng_Q4_Q1|Total_Trans_Amt|Total_Trans_Ct|Total_Ct_Chng_Q4_Q1|Avg_Utilization_Ratio|target|Gender_Indexed|Education_Level_Indexed|Marital_Status_Indexed|Income_Category_Indexed|Card_Category_Indexed|Gender_Indexed_Coded|Education_Level_Indexed_Coded|Marital_Status_Indexed_Coded|Income_Category_Indexed_Coded|Card_Category_Indexed_Coded|\n+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+--------------+-----------------------+----------------------+-----------------------+---------------------+--------------------+-----------------------------+----------------------------+-----------------------------+---------------------------+\n|Existing Customer|          45|     M|              3|    High School|       Married|    $60K - $80K|         Blue|            39|                       5|                     1|                    3|     12691.0|                777|        11914.0|               1.335|           1144|            42|              1.625|                0.061|     0|           1.0|                    1.0|                   0.0|                    3.0|                  0.0|           (1,[],[])|                (6,[1],[1.0])|               (3,[0],[1.0])|                (5,[3],[1.0])|              (3,[0],[1.0])|\n|Existing Customer|          49|     F|              5|       Graduate|        Single| Less than $40K|         Blue|            44|                       6|                     1|                    2|      8256.0|                864|         7392.0|               1.541|           1291|            33|              3.714|                0.105|     0|           0.0|                    0.0|                   1.0|                    0.0|                  0.0|       (1,[0],[1.0])|                (6,[0],[1.0])|               (3,[1],[1.0])|                (5,[0],[1.0])|              (3,[0],[1.0])|\n|Existing Customer|          51|     M|              3|       Graduate|       Married|   $80K - $120K|         Blue|            36|                       4|                     1|                    0|      3418.0|                  0|         3418.0|               2.594|           1887|            20|              2.333|                  0.0|     0|           1.0|                    0.0|                   0.0|                    2.0|                  0.0|           (1,[],[])|                (6,[0],[1.0])|               (3,[0],[1.0])|                (5,[2],[1.0])|              (3,[0],[1.0])|\n|Existing Customer|          40|     F|              4|    High School|       Unknown| Less than $40K|         Blue|            34|                       3|                     4|                    1|      3313.0|               2517|          796.0|               1.405|           1171|            20|              2.333|                 0.76|     0|           0.0|                    1.0|                   2.0|                    0.0|                  0.0|       (1,[0],[1.0])|                (6,[1],[1.0])|               (3,[2],[1.0])|                (5,[0],[1.0])|              (3,[0],[1.0])|\n|Existing Customer|          40|     M|              3|     Uneducated|       Married|    $60K - $80K|         Blue|            21|                       5|                     1|                    0|      4716.0|                  0|         4716.0|               2.175|            816|            28|                2.5|                  0.0|     0|           1.0|                    3.0|                   0.0|                    3.0|                  0.0|           (1,[],[])|                (6,[3],[1.0])|               (3,[0],[1.0])|                (5,[3],[1.0])|              (3,[0],[1.0])|\n+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+--------------+-----------------------+----------------------+-----------------------+---------------------+--------------------+-----------------------------+----------------------------+-----------------------------+---------------------------+\nonly showing top 5 rows\n\nimport org.apache.spark.ml.feature.OneHotEncoder\n\u001b[1m\u001b[34mcatColumns\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(Gender_Indexed_Coded, Education_Level_Indexed_Coded, Marital_Status_Indexed_Coded, Income_Category_Indexed_Coded, Card_Category_Indexed_Coded)\n\u001b[1m\u001b[34mencoder\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.OneHotEncoder\u001b[0m = oneHotEncoder_b00968eb7da5\n\u001b[1m\u001b[34mencoded\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [Attrition_Flag: string, Customer_Age: int ... 29 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=226"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776062_204513519","id":"paragraph_1606928813888_1302219435","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:281","dateStarted":"Oct 18, 2023, 1:55:40 PM","dateFinished":"Oct 18, 2023, 1:55:40 PM"},{"title":"Собираем признаки в вектор","text":"%md\n### Собираем признаки в вектор","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Собираем признаки в вектор</h3>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776062_1918493562","id":"paragraph_1606935374599_693272019","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:282"},{"text":"val featureColumns = numericColumnsFinal ++ catColumns\n\nval assembler = new VectorAssembler()\n  .setInputCols(featureColumns)\n  .setOutputCol(\"features\")\n\nval assembled = assembler.transform(encoded)\nassembled.show(5, truncate = false)","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:55:44 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"target","index":20,"aggr":"sum"}],"groups":[],"values":[{"name":"Customer_Age","index":1,"aggr":"avg"}],"setting":{"lineChart":{}}}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":260}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+--------------+-----------------------+----------------------+-----------------------+---------------------+--------------------+-----------------------------+----------------------------+-----------------------------+---------------------------+--------------------------------------------------------------------------------------------------------------------+\n|Attrition_Flag   |Customer_Age|Gender|Dependent_count|Education_Level|Marital_Status|Income_Category|Card_Category|Months_on_book|Total_Relationship_Count|Months_Inactive_12_mon|Contacts_Count_12_mon|Credit_Limit|Total_Revolving_Bal|Avg_Open_To_Buy|Total_Amt_Chng_Q4_Q1|Total_Trans_Amt|Total_Trans_Ct|Total_Ct_Chng_Q4_Q1|Avg_Utilization_Ratio|target|Gender_Indexed|Education_Level_Indexed|Marital_Status_Indexed|Income_Category_Indexed|Card_Category_Indexed|Gender_Indexed_Coded|Education_Level_Indexed_Coded|Marital_Status_Indexed_Coded|Income_Category_Indexed_Coded|Card_Category_Indexed_Coded|features                                                                                                            |\n+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+--------------+-----------------------+----------------------+-----------------------+---------------------+--------------------+-----------------------------+----------------------------+-----------------------------+---------------------------+--------------------------------------------------------------------------------------------------------------------+\n|Existing Customer|45          |M     |3              |High School    |Married       |$60K - $80K    |Blue         |39            |5                       |1                     |3                    |12691.0     |777                |11914.0        |1.335               |1144           |42            |1.625              |0.061                |0     |1.0           |1.0                    |0.0                   |3.0                    |0.0                  |(1,[],[])           |(6,[1],[1.0])                |(3,[0],[1.0])               |(5,[3],[1.0])                |(3,[0],[1.0])              |(28,[0,1,2,3,4,5,6,7,8,9,12,17,23,25],[45.0,3.0,5.0,1.0,3.0,11914.0,1.335,1144.0,1.625,0.061,1.0,1.0,1.0,1.0])      |\n|Existing Customer|49          |F     |5              |Graduate       |Single        |Less than $40K |Blue         |44            |6                       |1                     |2                    |8256.0      |864                |7392.0         |1.541               |1291           |33            |3.714              |0.105                |0     |0.0           |0.0                    |1.0                   |0.0                    |0.0                  |(1,[0],[1.0])       |(6,[0],[1.0])                |(3,[1],[1.0])               |(5,[0],[1.0])                |(3,[0],[1.0])              |(28,[0,1,2,3,4,5,6,7,8,9,10,11,18,20,25],[49.0,5.0,6.0,1.0,2.0,7392.0,1.541,1291.0,3.714,0.105,1.0,1.0,1.0,1.0,1.0])|\n|Existing Customer|51          |M     |3              |Graduate       |Married       |$80K - $120K   |Blue         |36            |4                       |1                     |0                    |3418.0      |0                  |3418.0         |2.594               |1887           |20            |2.333              |0.0                  |0     |1.0           |0.0                    |0.0                   |2.0                    |0.0                  |(1,[],[])           |(6,[0],[1.0])                |(3,[0],[1.0])               |(5,[2],[1.0])                |(3,[0],[1.0])              |(28,[0,1,2,3,5,6,7,8,11,17,22,25],[51.0,3.0,4.0,1.0,3418.0,2.594,1887.0,2.333,1.0,1.0,1.0,1.0])                     |\n|Existing Customer|40          |F     |4              |High School    |Unknown       |Less than $40K |Blue         |34            |3                       |4                     |1                    |3313.0      |2517               |796.0          |1.405               |1171           |20            |2.333              |0.76                 |0     |0.0           |1.0                    |2.0                   |0.0                    |0.0                  |(1,[0],[1.0])       |(6,[1],[1.0])                |(3,[2],[1.0])               |(5,[0],[1.0])                |(3,[0],[1.0])              |(28,[0,1,2,3,4,5,6,7,8,9,10,12,19,20,25],[40.0,4.0,3.0,4.0,1.0,796.0,1.405,1171.0,2.333,0.76,1.0,1.0,1.0,1.0,1.0])  |\n|Existing Customer|40          |M     |3              |Uneducated     |Married       |$60K - $80K    |Blue         |21            |5                       |1                     |0                    |4716.0      |0                  |4716.0         |2.175               |816            |28            |2.5                |0.0                  |0     |1.0           |3.0                    |0.0                   |3.0                    |0.0                  |(1,[],[])           |(6,[3],[1.0])                |(3,[0],[1.0])               |(5,[3],[1.0])                |(3,[0],[1.0])              |(28,[0,1,2,3,5,6,7,8,14,17,23,25],[40.0,3.0,5.0,1.0,4716.0,2.175,816.0,2.5,1.0,1.0,1.0,1.0])                        |\n+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+--------------+-----------------------+----------------------+-----------------------+---------------------+--------------------+-----------------------------+----------------------------+-----------------------------+---------------------------+--------------------------------------------------------------------------------------------------------------------+\nonly showing top 5 rows\n\n\u001b[1m\u001b[34mfeatureColumns\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(Customer_Age, Dependent_count, Total_Relationship_Count, Months_Inactive_12_mon, Contacts_Count_12_mon, Avg_Open_To_Buy, Total_Amt_Chng_Q4_Q1, Total_Trans_Amt, Total_Ct_Chng_Q4_Q1, Avg_Utilization_Ratio, Gender_Indexed_Coded, Education_Level_Indexed_Coded, Marital_Status_Indexed_Coded, Income_Category_Indexed_Coded, Card_Category_Indexed_Coded)\n\u001b[1m\u001b[34massembler\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.VectorAssembler\u001b[0m = VectorAssembler: uid=vecAssembler_9565a7465f03, handleInvalid=error, numInputCols=15\n\u001b[1m\u001b[34massembled\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [Attrition_Flag: string, Customer_Age: int ... 30 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=227"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776062_697267916","id":"paragraph_1606935405298_141435551","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:283","dateStarted":"Oct 18, 2023, 1:55:44 PM","dateFinished":"Oct 18, 2023, 1:55:44 PM"},{"text":"assembled.select(\"features\").show(5, truncate = false)","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:55:47 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":[{"mode":"table","graph":{"mode":"table","height":300,"optionOpen":false}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":262}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------------------------------------------------------------------------------------------------------+\n|features                                                                                                            |\n+--------------------------------------------------------------------------------------------------------------------+\n|(28,[0,1,2,3,4,5,6,7,8,9,12,17,23,25],[45.0,3.0,5.0,1.0,3.0,11914.0,1.335,1144.0,1.625,0.061,1.0,1.0,1.0,1.0])      |\n|(28,[0,1,2,3,4,5,6,7,8,9,10,11,18,20,25],[49.0,5.0,6.0,1.0,2.0,7392.0,1.541,1291.0,3.714,0.105,1.0,1.0,1.0,1.0,1.0])|\n|(28,[0,1,2,3,5,6,7,8,11,17,22,25],[51.0,3.0,4.0,1.0,3418.0,2.594,1887.0,2.333,1.0,1.0,1.0,1.0])                     |\n|(28,[0,1,2,3,4,5,6,7,8,9,10,12,19,20,25],[40.0,4.0,3.0,4.0,1.0,796.0,1.405,1171.0,2.333,0.76,1.0,1.0,1.0,1.0,1.0])  |\n|(28,[0,1,2,3,5,6,7,8,14,17,23,25],[40.0,3.0,5.0,1.0,4716.0,2.175,816.0,2.5,1.0,1.0,1.0,1.0])                        |\n+--------------------------------------------------------------------------------------------------------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=228"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776062_358068704","id":"paragraph_1630856948440_79111266","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:284","dateStarted":"Oct 18, 2023, 1:55:47 PM","dateFinished":"Oct 18, 2023, 1:55:47 PM"},{"title":"Нормализация","text":"%md\n### Нормализация","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Нормализация</h3>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776063_1269531664","id":"paragraph_1606942861432_256669139","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:285"},{"text":"import org.apache.spark.ml.feature.MinMaxScaler\n\nval scaler = new MinMaxScaler()\n  .setInputCol(\"features\")\n  .setOutputCol(\"scaledFeatures\")\n\nval scaled = scaler.fit(assembled).transform(assembled)\n\nscaled.select(\"features\", \"scaledFeatures\").show(5, truncate = false)","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:55:50 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"target","index":20,"aggr":"sum"}],"groups":[],"values":[{"name":"Customer_Age","index":1,"aggr":"avg"}],"setting":{"lineChart":{}}}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":273}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|features                                                                                                            |scaledFeatures                                                                                                                                                                                                                      |\n+--------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|(28,[0,1,2,3,4,5,6,7,8,9,12,17,23,25],[45.0,3.0,5.0,1.0,3.0,11914.0,1.335,1144.0,1.625,0.061,1.0,1.0,1.0,1.0])      |(28,[0,1,2,3,4,5,6,7,8,9,12,17,23,25],[0.40425531914893614,0.6000000000000001,0.8,0.16666666666666666,0.5,0.3451163329759801,0.39299381807477185,0.03527317236007566,0.43753365643511044,0.061061061061061066,1.0,1.0,1.0,1.0])     |\n|(28,[0,1,2,3,4,5,6,7,8,9,10,11,18,20,25],[49.0,5.0,6.0,1.0,2.0,7392.0,1.541,1291.0,3.714,0.105,1.0,1.0,1.0,1.0,1.0])|(28,[0,1,2,3,4,5,6,7,8,9,10,11,18,20,25],[0.48936170212765956,1.0,1.0,0.16666666666666666,0.3333333333333333,0.21409324022831977,0.4536355607889314,0.043451652386780906,1.0,0.10510510510510511,1.0,1.0,1.0,1.0,1.0])              |\n|(28,[0,1,2,3,5,6,7,8,11,17,22,25],[51.0,3.0,4.0,1.0,3418.0,2.594,1887.0,2.333,1.0,1.0,1.0,1.0])                     |(28,[0,1,2,3,5,6,7,8,11,17,22,25],[0.5319148936170213,0.6000000000000001,0.6000000000000001,0.16666666666666666,0.09894822240894735,0.7636149543715043,0.07661065984199399,0.6281637049003771,1.0,1.0,1.0,1.0])                     |\n|(28,[0,1,2,3,4,5,6,7,8,9,10,12,19,20,25],[40.0,4.0,3.0,4.0,1.0,796.0,1.405,1171.0,2.333,0.76,1.0,1.0,1.0,1.0,1.0])  |(28,[0,1,2,3,4,5,6,7,8,9,10,12,19,20,25],[0.2978723404255319,0.8,0.4,0.6666666666666666,0.16666666666666666,0.02297684930316113,0.41360023550191344,0.036775342160899074,0.6281637049003771,0.7607607607607608,1.0,1.0,1.0,1.0,1.0])|\n|(28,[0,1,2,3,5,6,7,8,14,17,23,25],[40.0,3.0,5.0,1.0,4716.0,2.175,816.0,2.5,1.0,1.0,1.0,1.0])                        |(28,[0,1,2,3,5,6,7,8,14,17,23,25],[0.2978723404255319,0.6000000000000001,0.8,0.16666666666666666,0.13655723930113292,0.6402708272004709,0.017024591075998664,0.6731287022078623,1.0,1.0,1.0,1.0])                                   |\n+--------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 5 rows\n\nimport org.apache.spark.ml.feature.MinMaxScaler\n\u001b[1m\u001b[34mscaler\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.MinMaxScaler\u001b[0m = minMaxScal_263e8ed683a2\n\u001b[1m\u001b[34mscaled\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [Attrition_Flag: string, Customer_Age: int ... 31 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=229"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=230"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=231"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776063_1131365607","id":"paragraph_1606942894534_1677248009","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:286","dateStarted":"Oct 18, 2023, 1:55:50 PM","dateFinished":"Oct 18, 2023, 1:55:51 PM"},{"title":"Feature Selection (отбор признаков)","text":"%md\n## Feature Selection (отбор признаков)","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Feature Selection (отбор признаков)</h2>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776063_1146397254","id":"paragraph_1606936425107_1654625172","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:287"},{"text":"import org.apache.spark.ml.feature.UnivariateFeatureSelector\n\nval selector = new UnivariateFeatureSelector()\n  .setFeatureType(\"continuous\")\n  .setLabelType(\"categorical\")\n  .setSelectionMode(\"percentile\")\n  .setSelectionThreshold(0.75)\n  .setFeaturesCol(\"scaledFeatures\")\n  .setLabelCol(\"target\")\n  .setOutputCol(\"selectedFeatures\")\n\nval dataF = selector.fit(scaled).transform(scaled)\n\ndataF.select(\"scaledFeatures\", \"selectedFeatures\").show(5, truncate = false)","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:55:56 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":[{"mode":"table","graph":{"mode":"table","height":300,"optionOpen":false}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":269}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|scaledFeatures                                                                                                                                                                                                                      |selectedFeatures                                                                                                                                                                                      |\n+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|(28,[0,1,2,3,4,5,6,7,8,9,12,17,23,25],[0.40425531914893614,0.6000000000000001,0.8,0.16666666666666666,0.5,0.3451163329759801,0.39299381807477185,0.03527317236007566,0.43753365643511044,0.061061061061061066,1.0,1.0,1.0,1.0])     |(21,[0,1,2,3,4,5,6,7,8,11,14,19],[0.40425531914893614,0.6000000000000001,0.8,0.16666666666666666,0.5,0.39299381807477185,0.03527317236007566,0.43753365643511044,0.061061061061061066,1.0,1.0,1.0])   |\n|(28,[0,1,2,3,4,5,6,7,8,9,10,11,18,20,25],[0.48936170212765956,1.0,1.0,0.16666666666666666,0.3333333333333333,0.21409324022831977,0.4536355607889314,0.043451652386780906,1.0,0.10510510510510511,1.0,1.0,1.0,1.0,1.0])              |(21,[0,1,2,3,4,5,6,7,8,9,10,15,17],[0.48936170212765956,1.0,1.0,0.16666666666666666,0.3333333333333333,0.4536355607889314,0.043451652386780906,1.0,0.10510510510510511,1.0,1.0,1.0,1.0])              |\n|(28,[0,1,2,3,5,6,7,8,11,17,22,25],[0.5319148936170213,0.6000000000000001,0.6000000000000001,0.16666666666666666,0.09894822240894735,0.7636149543715043,0.07661065984199399,0.6281637049003771,1.0,1.0,1.0,1.0])                     |(21,[0,1,2,3,5,6,7,10,14],[0.5319148936170213,0.6000000000000001,0.6000000000000001,0.16666666666666666,0.7636149543715043,0.07661065984199399,0.6281637049003771,1.0,1.0])                           |\n|(28,[0,1,2,3,4,5,6,7,8,9,10,12,19,20,25],[0.2978723404255319,0.8,0.4,0.6666666666666666,0.16666666666666666,0.02297684930316113,0.41360023550191344,0.036775342160899074,0.6281637049003771,0.7607607607607608,1.0,1.0,1.0,1.0,1.0])|(21,[0,1,2,3,4,5,6,7,8,9,11,16,17],[0.2978723404255319,0.8,0.4,0.6666666666666666,0.16666666666666666,0.41360023550191344,0.036775342160899074,0.6281637049003771,0.7607607607607608,1.0,1.0,1.0,1.0])|\n|(28,[0,1,2,3,5,6,7,8,14,17,23,25],[0.2978723404255319,0.6000000000000001,0.8,0.16666666666666666,0.13655723930113292,0.6402708272004709,0.017024591075998664,0.6731287022078623,1.0,1.0,1.0,1.0])                                   |(21,[0,1,2,3,5,6,7,14,19],[0.2978723404255319,0.6000000000000001,0.8,0.16666666666666666,0.6402708272004709,0.017024591075998664,0.6731287022078623,1.0,1.0])                                         |\n+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 5 rows\n\nimport org.apache.spark.ml.feature.UnivariateFeatureSelector\n\u001b[1m\u001b[34mselector\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.UnivariateFeatureSelector\u001b[0m = UnivariateFeatureSelector_fc63835dd979\n\u001b[1m\u001b[34mdataF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [Attrition_Flag: string, Customer_Age: int ... 32 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=232"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=233"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=234"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=235"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776063_1278293268","id":"paragraph_1630859979568_2121348298","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:288","dateStarted":"Oct 18, 2023, 1:55:56 PM","dateFinished":"Oct 18, 2023, 1:55:58 PM"},{"text":"%md\n## Моделирование","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Моделирование</h2>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776063_88263874","id":"paragraph_1606979632853_1187448866","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:289"},{"title":"Обучающая и тестовая выборки","text":"%md\n### Обучающая и тестовая выборки","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Обучающая и тестовая выборки</h3>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776063_1453045918","id":"paragraph_1606979694470_614729586","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:290"},{"text":"val tt: Array[Dataset[Row]] = dataF.randomSplit(Array(0.7, 0.3))\nval training = tt(0)\nval test = tt(1)\n\nprintln(s\"training\\t${training.count}\\ntest    \\t${test.count}\")","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:56:02 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":253}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"training\t11630\ntest    \t5005\n\u001b[1m\u001b[34mtt\u001b[0m: \u001b[1m\u001b[32mArray[org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]]\u001b[0m = Array([Attrition_Flag: string, Customer_Age: int ... 32 more fields], [Attrition_Flag: string, Customer_Age: int ... 32 more fields])\n\u001b[1m\u001b[34mtraining\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [Attrition_Flag: string, Customer_Age: int ... 32 more fields]\n\u001b[1m\u001b[34mtest\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [Attrition_Flag: string, Customer_Age: int ... 32 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=236"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=237"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=238"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=239"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776064_1695298102","id":"paragraph_1606979977097_792209855","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:291","dateStarted":"Oct 18, 2023, 1:56:02 PM","dateFinished":"Oct 18, 2023, 1:56:03 PM"},{"title":"Логистическая регрессия","text":"%md\n### Логистическая регрессия","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Логистическая регрессия</h3>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776064_611566982","id":"paragraph_1606930225109_613083627","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:292"},{"text":"import org.apache.spark.ml.classification.LogisticRegression\n\nval lr = new LogisticRegression()\n        .setMaxIter(1000)\n        .setRegParam(0.2)\n        .setElasticNetParam(0.8)\n        .setFamily(\"binomial\")\n        .setFeaturesCol(\"selectedFeatures\")\n        .setLabelCol(\"target\")\n\nval lrModel = lr.fit(training)\n\nprintln(s\"Coefficients: ${lrModel.coefficients}\\nIntercept: ${lrModel.intercept}\")","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:56:05 PM","progress":100,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":210}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Coefficients: (21,[7],[-1.6055973352127735])\nIntercept: 0.24098279966474415\nimport org.apache.spark.ml.classification.LogisticRegression\n\u001b[1m\u001b[34mlr\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.classification.LogisticRegression\u001b[0m = logreg_e743859e8aec\n\u001b[1m\u001b[34mlrModel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.classification.LogisticRegressionModel\u001b[0m = LogisticRegressionModel: uid=logreg_e743859e8aec, numClasses=2, numFeatures=21\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=240"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=241"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=242"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=243"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=244"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=245"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=246"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=247"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=248"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=249"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=250"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=251"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776064_1068825260","id":"paragraph_1606944138760_1098539657","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:293","dateStarted":"Oct 18, 2023, 1:56:05 PM","dateFinished":"Oct 18, 2023, 1:56:08 PM"},{"title":"Training Summary","text":"%md\n### Training Summary","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Training Summary</h3>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776064_1997242263","id":"paragraph_1606982362991_1366184264","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:294"},{"text":"val trainingSummary = lrModel.binarySummary\n\nprintln(s\"accuracy: ${trainingSummary.accuracy}\")\nprintln(s\"areaUnderROC: ${trainingSummary.areaUnderROC}\")","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:56:11 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":208}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"accuracy: 0.6989681857265693\nareaUnderROC: 0.7456246708677258\n\u001b[1m\u001b[34mtrainingSummary\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.classification.BinaryLogisticRegressionTrainingSummary\u001b[0m = org.apache.spark.ml.classification.BinaryLogisticRegressionTrainingSummaryImpl@5b1a854d\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=252"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=253"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=254"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=255"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=256"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776064_718116116","id":"paragraph_1606980220044_1011474675","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:295","dateStarted":"Oct 18, 2023, 1:56:11 PM","dateFinished":"Oct 18, 2023, 1:56:12 PM"},{"title":"Проверяем модель на тестовой выборке","text":"%md\n### Проверяем модель на тестовой выборке","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Проверяем модель на тестовой выборке</h3>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776064_818009326","id":"paragraph_1606980801129_208018861","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:296"},{"text":"val predicted = lrModel.transform(test)\n\npredicted.select(\"target\", \"rawPrediction\", \"probability\", \"prediction\").show(10, truncate = false)","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:56:15 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"target","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"prediction","index":3,"aggr":"avg"}],"setting":{"lineChart":{}}}}],"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":432}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+--------------------------------------------+----------------------------------------+----------+\n|target|rawPrediction                               |probability                             |prediction|\n+------+--------------------------------------------+----------------------------------------+----------+\n|0     |[0.03353370756738058,-0.03353370756738058]  |[0.5083826413765483,0.4916173586234517] |0.0       |\n|0     |[-0.03736504390674297,0.03736504390674297]  |[0.49065982568567346,0.5093401743143265]|1.0       |\n|0     |[0.15112188074397578,-0.15112188074397578]  |[0.5377087320421009,0.4622912679578991] |0.0       |\n|0     |[-0.024828069560708932,0.024828069560708932]|[0.4937933014410512,0.5062066985589488] |1.0       |\n|0     |[0.07676465358818765,-0.07676465358818765]  |[0.5191817447873229,0.48081825521267707]|0.0       |\n|0     |[-0.0836221561490065,0.0836221561490065]    |[0.4791066345694831,0.5208933654305169] |1.0       |\n|0     |[-0.006238762771761858,0.006238762771761858]|[0.4984403143659175,0.5015596856340825] |1.0       |\n|0     |[-0.09702374941545669,0.09702374941545669]  |[0.47576307274137164,0.5242369272586284]|1.0       |\n|0     |[-0.03736504390674297,0.03736504390674297]  |[0.49065982568567346,0.5093401743143265]|1.0       |\n|0     |[-0.006671072231969971,0.006671072231969971]|[0.49833223812706523,0.5016677618729348]|1.0       |\n+------+--------------------------------------------+----------------------------------------+----------+\nonly showing top 10 rows\n\n\u001b[1m\u001b[34mpredicted\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [Attrition_Flag: string, Customer_Age: int ... 35 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=257"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776064_1413592062","id":"paragraph_1606983058060_2095098456","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:297","dateStarted":"Oct 18, 2023, 1:56:15 PM","dateFinished":"Oct 18, 2023, 1:56:16 PM"},{"text":"predicted.show(5)","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:56:18 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":265}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+--------------+-----------------------+----------------------+-----------------------+---------------------+--------------------+-----------------------------+----------------------------+-----------------------------+---------------------------+--------------------+--------------------+--------------------+--------------------+--------------------+----------+\n|   Attrition_Flag|Customer_Age|Gender|Dependent_count|Education_Level|Marital_Status|Income_Category|Card_Category|Months_on_book|Total_Relationship_Count|Months_Inactive_12_mon|Contacts_Count_12_mon|Credit_Limit|Total_Revolving_Bal|Avg_Open_To_Buy|Total_Amt_Chng_Q4_Q1|Total_Trans_Amt|Total_Trans_Ct|Total_Ct_Chng_Q4_Q1|Avg_Utilization_Ratio|target|Gender_Indexed|Education_Level_Indexed|Marital_Status_Indexed|Income_Category_Indexed|Card_Category_Indexed|Gender_Indexed_Coded|Education_Level_Indexed_Coded|Marital_Status_Indexed_Coded|Income_Category_Indexed_Coded|Card_Category_Indexed_Coded|            features|      scaledFeatures|    selectedFeatures|       rawPrediction|         probability|prediction|\n+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+--------------+-----------------------+----------------------+-----------------------+---------------------+--------------------+-----------------------------+----------------------------+-----------------------------+---------------------------+--------------------+--------------------+--------------------+--------------------+--------------------+----------+\n|Existing Customer|          26|     F|              0|        College|       Married|    $40K - $60K|         Blue|            13|                       2|                     3|                    3|      2010.0|               1070|          940.0|               0.906|           3625|            85|              0.635|                0.532|     0|           0.0|                    4.0|                   0.0|                    1.0|                  0.0|       (1,[0],[1.0])|                (6,[4],[1.0])|               (3,[0],[1.0])|                (5,[1],[1.0])|              (3,[0],[1.0])|(28,[0,2,3,4,5,6,...|(28,[2,3,4,5,6,7,...|(21,[2,3,4,5,6,7,...|[0.03353370756738...|[0.50838264137654...|       0.0|\n|Existing Customer|          26|     F|              0|       Graduate|        Single|    $40K - $60K|         Blue|            13|                       6|                     3|                    4|      1643.0|               1101|          542.0|               0.713|           2152|            50|              0.471|                 0.67|     0|           0.0|                    0.0|                   1.0|                    1.0|                  0.0|       (1,[0],[1.0])|                (6,[0],[1.0])|               (3,[1],[1.0])|                (5,[1],[1.0])|              (3,[0],[1.0])|(28,[0,2,3,4,5,6,...|(28,[2,3,4,5,6,7,...|(21,[2,3,4,5,6,7,...|[-0.0373650439067...|[0.49065982568567...|       1.0|\n|Existing Customer|          26|     F|              0|       Graduate|        Single| Less than $40K|         Blue|            22|                       3|                     1|                    3|      1486.0|                  0|         1486.0|               0.734|           4535|            82|              0.907|                  0.0|     0|           0.0|                    0.0|                   1.0|                    0.0|                  0.0|       (1,[0],[1.0])|                (6,[0],[1.0])|               (3,[1],[1.0])|                (5,[0],[1.0])|              (3,[0],[1.0])|(28,[0,2,3,4,5,6,...|(28,[2,3,4,5,6,7,...|(21,[2,3,4,5,6,7,...|[0.15112188074397...|[0.53770873204210...|       0.0|\n|Existing Customer|          26|     F|              0|    High School|        Single| Less than $40K|         Blue|            13|                       6|                     3|                    4|      3517.0|               1195|         2322.0|               0.556|           2255|            48|                0.5|                 0.34|     0|           0.0|                    1.0|                   1.0|                    0.0|                  0.0|       (1,[0],[1.0])|                (6,[1],[1.0])|               (3,[1],[1.0])|                (5,[0],[1.0])|              (3,[0],[1.0])|(28,[0,2,3,4,5,6,...|(28,[2,3,4,5,6,7,...|(21,[2,3,4,5,6,7,...|[-0.0248280695607...|[0.49379330144105...|       1.0|\n|Existing Customer|          26|     F|              0|     Uneducated|       Unknown|        Unknown|       Silver|            13|                       1|                     2|                    3|     34516.0|               2403|        32113.0|               0.623|           4174|            59|              0.735|                 0.07|     0|           0.0|                    3.0|                   2.0|                    4.0|                  1.0|       (1,[0],[1.0])|                (6,[3],[1.0])|               (3,[2],[1.0])|                (5,[4],[1.0])|              (3,[1],[1.0])|(28,[0,2,3,4,5,6,...|(28,[3,4,5,6,7,8,...|(21,[3,4,5,6,7,8,...|[0.07676465358818...|[0.51918174478732...|       0.0|\n+-----------------+------------+------+---------------+---------------+--------------+---------------+-------------+--------------+------------------------+----------------------+---------------------+------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+---------------------+------+--------------+-----------------------+----------------------+-----------------------+---------------------+--------------------+-----------------------------+----------------------------+-----------------------------+---------------------------+--------------------+--------------------+--------------------+--------------------+--------------------+----------+\nonly showing top 5 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=258"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776065_2136996390","id":"paragraph_1657303600739_395841439","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:298","dateStarted":"Oct 18, 2023, 1:56:18 PM","dateFinished":"Oct 18, 2023, 1:56:19 PM"},{"text":"import org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\n\nval evaluator = new BinaryClassificationEvaluator().setLabelCol(\"target\")\n\nprintln(s\"areaUnderROC: ${evaluator.evaluate(predicted)}\\n\")","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:56:21 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":206}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"areaUnderROC: 0.7446245975119651\n\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\n\u001b[1m\u001b[34mevaluator\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.evaluation.BinaryClassificationEvaluator\u001b[0m = BinaryClassificationEvaluator: uid=binEval_87fad05bc85f, metricName=areaUnderROC, numBins=1000\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=259"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=260"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=261"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=262"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776065_388711314","id":"paragraph_1606983703027_2004031850","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:299","dateStarted":"Oct 18, 2023, 1:56:21 PM","dateFinished":"Oct 18, 2023, 1:56:22 PM"},{"title":"Confusion Matrix (матрица ошибок)","text":"%md\n#### Confusion Matrix (матрица ошибок)\n\n* True Positive (TP) - label is positive and prediction is also positive\n* True Negative (TN) - label is negative and prediction is also negative\n* False Positive (FP) - label is negative but prediction is positive\n* False Negative (FN) - label is positive but prediction is negative","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":187},"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Confusion Matrix (матрица ошибок)</h4>\n<ul>\n<li>True Positive (TP) - label is positive and prediction is also positive</li>\n<li>True Negative (TN) - label is negative and prediction is also negative</li>\n<li>False Positive (FP) - label is negative but prediction is positive</li>\n<li>False Negative (FN) - label is positive but prediction is negative</li>\n</ul>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776065_232439979","id":"paragraph_1606988325387_1831808377","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:300"},{"text":"val tp = predicted.filter(($\"target\" === 1) and ($\"prediction\" === 1)).count\nval tn = predicted.filter(($\"target\" === 0) and ($\"prediction\" === 0)).count\nval fp = predicted.filter(($\"target\" === 0) and ($\"prediction\" === 1)).count\nval fn = predicted.filter(($\"target\" === 1) and ($\"prediction\" === 0)).count\n\nprintln(s\"Confusion Matrix:\\n$tp\\t $fp\\n$fn\\t$tn\\n\")","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:56:26 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":293}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Confusion Matrix:\n1334\t 368\n1101\t2202\n\n\u001b[1m\u001b[34mtp\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 1334\n\u001b[1m\u001b[34mtn\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 2202\n\u001b[1m\u001b[34mfp\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 368\n\u001b[1m\u001b[34mfn\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 1101\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=263"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=264"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=265"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=266"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=267"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=268"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=269"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=270"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776065_30592479","id":"paragraph_1606988763832_1393606251","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:301","dateStarted":"Oct 18, 2023, 1:56:26 PM","dateFinished":"Oct 18, 2023, 1:56:29 PM"},{"title":"Accuracy, Precision, Recall","text":"%md\n#### Accuracy, Precision, Recall\n\n* Accuracy (доля правильных ответов) = TP + TN / TP + TN + FP + FN\n* Precision (точность) = TP / TP + FP\n* Recall (полнота) = TP / TP + FN","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":170}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Accuracy, Precision, Recall</h4>\n<ul>\n<li>Accuracy (доля правильных ответов) = TP + TN / TP + TN + FP + FN</li>\n<li>Precision (точность) = TP / TP + FP</li>\n<li>Recall (полнота) = TP / TP + FN</li>\n</ul>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776065_1584631252","id":"paragraph_1606989226436_1108351324","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:302"},{"text":"val accuracy = (tp + tn) / (tp + tn + fp + fn).toDouble\nval precision = tp / (tp + fp).toDouble\nval recall = tp / (tp + fn).toDouble\n\nprintln(s\"Accuracy = $accuracy\")\nprintln(s\"Precision = $precision\")\nprintln(s\"Recall = $recall\\n\")","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:56:33 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":298}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Accuracy = 0.7064935064935065\nPrecision = 0.7837837837837838\nRecall = 0.5478439425051335\n\n\u001b[1m\u001b[34maccuracy\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.7064935064935065\n\u001b[1m\u001b[34mprecision\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.7837837837837838\n\u001b[1m\u001b[34mrecall\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.5478439425051335\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776065_1920795942","id":"paragraph_1606989536689_176168868","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:303","dateStarted":"Oct 18, 2023, 1:56:33 PM","dateFinished":"Oct 18, 2023, 1:56:33 PM"},{"title":"Настраиваем модель (подбираем гиперпараметры)","text":"%md\n## Настраиваем модель (подбираем гиперпараметры)","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Настраиваем модель (подбираем гиперпараметры)</h2>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776066_105851647","id":"paragraph_1606989656999_239959159","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:304"},{"text":"import org.apache.spark.ml.tuning.{ParamGridBuilder, TrainValidationSplit}\n\nval paramGrid = new ParamGridBuilder()\n  .addGrid(lr.regParam, Array(0.01, 0.1, 0.5))\n  .addGrid(lr.fitIntercept)\n  .addGrid(lr.elasticNetParam, Array(0.0, 0.5, 1.0))\n  .build()\n\nval trainValidationSplit = new TrainValidationSplit()\n  .setEstimator(lr)\n  .setEvaluator(evaluator)\n  .setEstimatorParamMaps(paramGrid)\n  .setTrainRatio(0.7)\n  .setParallelism(2)\n\nval model = trainValidationSplit.fit(dataF)","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:56:36 PM","progress":100,"config":{"lineNumbers":true,"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":444}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.tuning.{ParamGridBuilder, TrainValidationSplit}\n\u001b[1m\u001b[34mparamGrid\u001b[0m: \u001b[1m\u001b[32mArray[org.apache.spark.ml.param.ParamMap]\u001b[0m =\nArray({\n\tlogreg_e743859e8aec-elasticNetParam: 0.0,\n\tlogreg_e743859e8aec-fitIntercept: true,\n\tlogreg_e743859e8aec-regParam: 0.01\n}, {\n\tlogreg_e743859e8aec-elasticNetParam: 0.0,\n\tlogreg_e743859e8aec-fitIntercept: true,\n\tlogreg_e743859e8aec-regParam: 0.1\n}, {\n\tlogreg_e743859e8aec-elasticNetParam: 0.0,\n\tlogreg_e743859e8aec-fitIntercept: true,\n\tlogreg_e743859e8aec-regParam: 0.5\n}, {\n\tlogreg_e743859e8aec-elasticNetParam: 0.5,\n\tlogreg_e743859e8aec-fitIntercept: true,\n\tlogreg_e743859e8aec-regParam: 0.01\n}, {\n\tlogreg_e743859e8aec-elasticNetParam: 0.5,\n\tlogreg_e743859e8aec-fitIntercept: true,\n\tlogreg_e743859e8aec-regParam: 0.1\n}, {\n\tlogreg_e74...\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=271"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=272"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=273"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=274"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=275"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=276"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=277"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=278"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=279"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=280"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=281"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=282"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=283"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=284"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=285"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=286"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=287"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=288"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=289"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=290"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=291"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=292"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=293"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=294"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=295"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=296"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=297"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=298"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=299"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=300"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=301"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=302"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=303"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=304"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=305"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=307"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=306"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=308"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=309"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=310"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=311"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=312"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=313"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=314"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=315"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=316"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=317"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=318"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=319"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=320"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=321"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=322"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=323"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=324"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=325"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=326"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=327"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=328"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=329"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=330"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=331"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=332"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=333"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=334"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=335"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=336"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=337"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=338"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=339"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=340"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=341"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=342"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=343"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=344"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=345"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=346"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=347"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=348"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=349"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=350"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=351"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=352"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=353"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=354"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=355"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=356"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=357"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=358"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=359"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=360"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=361"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=362"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=363"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=364"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=365"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=366"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=367"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=368"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=369"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=370"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=371"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=372"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=373"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=374"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=375"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=376"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=377"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=378"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=379"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=380"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=381"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=382"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=383"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=384"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=385"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=386"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=387"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=388"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=389"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=390"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=391"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=392"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=393"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=394"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=395"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=396"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=397"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=398"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=399"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=400"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=401"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=402"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=403"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=404"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=405"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=406"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=407"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=408"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=409"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=410"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=411"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=412"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=413"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=414"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=415"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=416"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=417"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=418"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=419"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=420"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=421"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=422"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=423"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=424"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=425"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=426"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=427"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=428"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=429"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=430"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=431"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=432"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=433"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=434"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=435"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=436"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=437"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=438"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=439"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=440"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=441"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=442"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=443"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=444"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=445"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=446"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=447"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=448"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=449"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=450"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=451"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=452"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=453"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=454"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=455"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=456"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=457"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=458"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=459"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=460"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=461"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=462"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=463"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=464"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=465"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=466"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=467"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=468"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=469"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=470"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=471"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=472"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=473"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=474"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=475"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=476"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=477"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=478"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=479"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=480"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=481"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=482"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=483"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=484"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=485"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=486"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=487"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=488"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=489"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=490"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=491"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=492"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=493"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=494"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=495"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=496"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=497"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=498"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=499"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=500"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=501"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=502"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=503"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=504"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=505"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=506"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=507"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=508"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=509"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=510"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=511"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=512"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=513"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=514"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=515"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=516"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=517"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=518"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=519"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=520"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=521"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=522"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=523"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=524"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=525"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=526"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=527"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=528"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=529"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=530"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=531"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=532"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=533"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=534"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=535"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=536"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=537"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=538"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=539"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=540"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=541"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=542"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=543"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=544"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=545"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=546"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=547"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=548"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=549"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=550"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=551"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=552"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=553"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=554"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=555"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=556"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=557"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=558"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=559"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=560"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=561"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=562"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=563"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=564"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=565"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=566"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=567"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=568"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=569"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=570"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=571"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=572"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=573"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=574"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=575"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=576"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=577"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=578"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=579"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=580"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=581"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=582"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=583"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=584"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=585"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=586"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=587"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=588"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=589"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=590"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=591"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=592"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=593"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=594"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=595"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=596"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=597"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=598"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=599"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=600"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=601"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=602"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=603"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=604"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=605"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=606"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=607"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=608"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=609"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=610"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=611"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=612"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=613"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=614"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=615"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=616"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=617"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=618"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=619"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=620"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=621"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=622"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=623"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=624"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=625"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=626"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=627"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=628"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=629"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=630"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=631"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=632"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=633"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=634"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=635"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=636"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=637"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=638"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=639"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=640"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=641"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=642"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=643"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=644"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=645"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=646"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=647"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=648"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=649"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=650"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=651"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=652"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=653"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=654"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=655"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=656"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=657"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=658"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=659"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=660"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=661"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=662"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=663"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=664"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=665"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=666"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=667"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=668"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=669"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=670"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=671"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=672"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=673"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=674"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=675"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=676"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=677"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=678"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=679"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=680"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=681"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=682"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=683"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=684"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=685"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=686"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=687"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=688"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=689"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=690"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=691"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=692"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=693"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=694"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=695"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=696"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=697"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=698"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=699"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=700"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=701"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=702"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=703"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=704"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=705"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=706"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=707"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=708"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=709"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=710"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=711"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=712"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=713"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=714"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=715"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=716"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=717"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=718"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=719"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=720"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=721"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=722"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=723"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=724"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=725"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=726"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=727"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=728"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=729"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=730"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=731"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=732"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=733"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=734"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=735"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=736"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=737"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=738"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=739"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=740"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=741"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=742"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=743"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=744"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=745"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=746"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=747"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=748"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=749"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=750"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=751"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=752"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=753"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=754"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=755"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=756"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=757"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=758"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=759"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=760"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=761"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=762"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=763"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=764"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=765"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=766"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=767"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=768"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=769"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=770"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=771"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=772"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=773"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=774"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=775"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=776"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=777"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=778"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=779"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=780"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=781"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=782"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=783"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=784"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=785"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=786"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=787"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=788"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=789"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=790"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=791"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=792"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=793"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=794"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=795"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=796"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=797"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=798"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=799"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=800"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=801"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=802"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=803"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=804"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=805"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=806"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=807"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=808"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=809"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=810"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=811"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=812"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=813"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=814"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=815"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=816"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=817"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=818"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=819"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=820"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=821"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=822"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=823"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=824"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=825"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=826"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=827"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=828"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=829"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=830"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=831"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=832"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=833"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=834"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=835"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=836"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=837"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=838"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=839"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=840"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=841"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=842"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=843"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=844"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=845"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=846"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=847"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=848"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=849"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=850"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=851"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=852"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=853"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=854"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=855"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=856"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=857"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=858"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=859"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=860"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=861"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=862"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=863"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=864"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776066_933524978","id":"paragraph_1630873148944_2004894713","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:305","dateStarted":"Oct 18, 2023, 1:56:36 PM","dateFinished":"Oct 18, 2023, 1:56:51 PM"},{"text":"model.bestModel.extractParamMap()","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:56:55 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":552}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mres133\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.param.ParamMap\u001b[0m =\n{\n\tlogreg_e743859e8aec-aggregationDepth: 2,\n\tlogreg_e743859e8aec-elasticNetParam: 0.0,\n\tlogreg_e743859e8aec-family: binomial,\n\tlogreg_e743859e8aec-featuresCol: selectedFeatures,\n\tlogreg_e743859e8aec-fitIntercept: true,\n\tlogreg_e743859e8aec-labelCol: target,\n\tlogreg_e743859e8aec-maxBlockSizeInMB: 0.0,\n\tlogreg_e743859e8aec-maxIter: 1000,\n\tlogreg_e743859e8aec-predictionCol: prediction,\n\tlogreg_e743859e8aec-probabilityCol: probability,\n\tlogreg_e743859e8aec-rawPredictionCol: rawPrediction,\n\tlogreg_e743859e8aec-regParam: 0.01,\n\tlogreg_e743859e8aec-standardization: true,\n\tlogreg_e743859e8aec-threshold: 0.5,\n\tlogreg_e743859e8aec-tol: 1.0E-6\n}\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776066_1747363174","id":"paragraph_1630873355257_297370638","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:306","dateStarted":"Oct 18, 2023, 1:56:55 PM","dateFinished":"Oct 18, 2023, 1:56:55 PM"},{"text":"val bestML = model.bestModel","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:56:58 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":111}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mbestML\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.Model[_]\u001b[0m = LogisticRegressionModel: uid=logreg_e743859e8aec, numClasses=2, numFeatures=21\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776066_1303441766","id":"paragraph_1606994194863_471908838","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:307","dateStarted":"Oct 18, 2023, 1:56:58 PM","dateFinished":"Oct 18, 2023, 1:56:58 PM"},{"title":"Собираем всё вместе (Pipeline)","text":"%md\n## Собираем всё вместе (Pipeline)\n\n1. Отобрали числовые признаки: numericColumnsFinal\n2. Проиндексировали строковые признаки: indexer\n3. Закодировали категориальные признаки: encoder\n4. Собрали признаки в вектор: assembler\n5. Нормализовали признаки: scaler\n6. Провели отбор признаков: selector\n7. Рассчитали модель: bestML ","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Собираем всё вместе (Pipeline)</h2>\n<ol>\n<li>Отобрали числовые признаки: numericColumnsFinal</li>\n<li>Проиндексировали строковые признаки: indexer</li>\n<li>Закодировали категориальные признаки: encoder</li>\n<li>Собрали признаки в вектор: assembler</li>\n<li>Нормализовали признаки: scaler</li>\n<li>Провели отбор признаков: selector</li>\n<li>Рассчитали модель: bestML</li>\n</ol>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776066_2059646100","id":"paragraph_1606990560406_1109228306","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:308"},{"text":"import org.apache.spark.ml.Pipeline\n\nval pipeline = new Pipeline().setStages(Array(indexer, encoder, assembler, scaler, selector, bestML))","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:57:01 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.Pipeline\n\u001b[1m\u001b[34mpipeline\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.Pipeline\u001b[0m = pipeline_ce7a7652a3b6\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776066_1186498119","id":"paragraph_1606990637145_1162649591","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:309","dateStarted":"Oct 18, 2023, 1:57:01 PM","dateFinished":"Oct 18, 2023, 1:57:01 PM"},{"text":"val Array(trainingData, testData) = data.randomSplit(Array(0.7, 0.3))\n\nval pipelineModel = pipeline.fit(trainingData)","user":"anonymous","dateUpdated":"Oct 18, 2023, 1:57:04 PM","progress":100,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":233}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mtrainingData\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [Attrition_Flag: string, Customer_Age: int ... 19 more fields]\n\u001b[1m\u001b[34mtestData\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [Attrition_Flag: string, Customer_Age: int ... 19 more fields]\n\u001b[1m\u001b[34mpipelineModel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.PipelineModel\u001b[0m = pipeline_ce7a7652a3b6\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=865"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=866"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=867"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=868"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=869"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=870"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=871"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776066_1682130396","id":"paragraph_1606994332674_1689862144","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:310","dateStarted":"Oct 18, 2023, 1:57:04 PM","dateFinished":"Oct 18, 2023, 1:57:06 PM"},{"title":"Сохраняем модель","text":"%md\n## Сохраняем модель","user":"anonymous","dateUpdated":"2023-10-18T13:42:56+0300","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"state":{}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Сохраняем модель</h2>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776066_1489791586","id":"paragraph_1606995403385_1969585559","dateCreated":"2023-10-18T13:42:56+0300","status":"READY","$$hashKey":"object:311"},{"text":"pipelineModel.write.overwrite().save(\"workspace/spark/SparkML/pipelineModel\")","user":"anonymous","dateUpdated":"Oct 18, 2023, 2:00:17 PM","progress":100,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=923"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=924"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=925"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=926"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=927"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=928"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=929"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=930"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=931"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=932"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=933"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=934"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=935"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=936"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=937"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=938"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=939"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1697625776067_1468710958","id":"paragraph_1657543157706_1350449220","dateCreated":"Oct 18, 2023, 1:42:56 PM","status":"FINISHED","$$hashKey":"object:313","results":{"code":"SUCCESS","msg":[]},"dateStarted":"Oct 18, 2023, 1:58:57 PM","dateFinished":"Oct 18, 2023, 1:58:58 PM"},{"id":"paragraph_1697626743178_721374159","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":""}],"info":{},"noteForms":{},"noteParams":{},"angularObjects":{}}